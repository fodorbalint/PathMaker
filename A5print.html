<style type="text/css" media="print">
@page {
    margin-top: 0;
    margin-bottom: 0;
    margin-left: 28.5px;
    margin-right: 28.5px;
    orientation: portrait; 
    /* size: A5; disables orientation option, and it can be wrong. */
}
</style>
<style>
    :root {
        --text: black;
        --bg: white;
        --border: white;
        --divbg: white;
    }
    @media (prefers-color-scheme: dark) {
        :root {
            --text: #fff;
            --bg: #000;
            --border: gray;
            --divbg: #800000;
        }
    }

    body {
        background-color: var(--bg);
        font-family: Garamond;
        margin: 0px;
    }
    table {
        border-spacing: 0px;  
        margin-top: 0px;
    }
    td { /* 820 x 520 */
        border: 0px solid #808080;  
        width: 400px;    
        height: 820px;  
        vertical-align: top;
        position: relative;
        padding-left: 60px;
        padding-right: 60px;
        padding-top: 72px;
        padding-bottom: 108px;        
        font-size: 16px;
        text-align: justify;
        line-height: 22px;
    }
    div {
        width: 400px;
        height: 640px;
        overflow-y: visible;
        color: var(--text);
        box-shadow: inset 0 0 0 1000px var(--divbg);
    }    
    div.border {
        position: absolute;
        left: 0px;
        top: 0px;
        width: 100%;
        height: 100%;
        box-shadow: inset 0 0 0 1px var(--border);
    }
    div.num {
        position: absolute;
        text-align: center;
        left: 0px;
        bottom: 46px;
        width: 100%;
        height: 16px;
        overflow: visible;
        box-shadow: inset 0 0 0 1000px transparent;
    }
    .header {
        font-size: 20px;
        font-weight: bold;
    }
    div.border_sample {
        position: absolute;
        text-align: center;
        left: 0px;
        top: 0px;
        width: 100%;
        height: 100%;
        box-shadow: inset 0 0 0 1000px #e0e0e0;
    }
    div.content_sample {
        position: absolute;
        text-align: center;
        width: 400px;
        box-shadow: inset 0 0 0 1000px #c0c0c0;
    }
    div.num_sample {
        position: absolute;
        text-align: center;
        left: 0px;
        bottom: 46px;
        width: 100%;
        height: 16px;
        overflow: visible;
        box-shadow: inset 0 0 0 1000px #c0c0c0;
    }
    .cover {
        position: absolute;
        left: 26px;
        top: 41px;
        width: 90%;
        height: 90%;
    }

</style>
<table width="520" align="center">
        <tr><td><div class="border_sample">Page: 130 x 205 mm<br />Screen resolution: 520 x 820 px</div><div class="content_sample">Content: 100 x 160 mm<br />Screen resolution: 400 x 640 px<br />Font: 16 px Garamond</div><div class="num_sample">Number box height: 4 mm / 16 px</div></td></tr>
        <tr><td><img class="cover" src="References/cover.svg"/></td></tr>
        <tr><td><div class="border"></div><div>Do you know in how many different ways you can fill a square grid, visiting each point once?<br />
        What is the recipe of generating them all without ever getting stuck?<br />
        <br />
        In this book I present a solution to one of the riddles of mathematics. It is complex in a way that you need to think about all possibilities but simple enough to understand if you just know the basic mathematical operations.<br />
        <br />
        The majority of work involved writing a computer program. This book contains the important points to take into consideration when doing so.
        </div></td></tr>
        <tr><td><div class="border"></div><div><span class="header">The one-way labyrinth algorithm</span><br />
<br />
This research aims to solve the following problem:<br />
"Draw a line that goes through an n x n grid (where n is an odd number), passing through each field once. The line has to start from the field at the upper left corner (1,1) and end at (n,n). At any time it is allowed to move left, right, up or down, and it has to randomly choose between the available fields."<br />
<br />
At first sight it may look easy. But look at the following example:<br />
<br />
<img src="References/0701_1.svg" /><br />
<br />
Based on the black line's shape, blue fragments were drawn to indicate a path we have to go through in the future.</div><div class="num">1</div></td></tr>
<tr><td><div class="border"></div><div>The gray fields are the available fields to step on next.<br />
Do you see why the situation is impossible from now on?<br />
<br />
The question is, is there a single rule or a set of rules that will guarantee you can draw a labyrinth of any size? Or do the rules get infinitely complex?<br />
It is not a viable option to draw the path until it cannot continue, only to step back and choose a different direction at some point. For a 21 x 21 grid, the number of steps are 440, and for each step, if we have to choose between 3 directions, the number of operations would be immense: 3<sup>440</sup><br />
In turn, if we found an algorithm that requires at most a * n<sup>b</sup> operations (where a and b are fixed numbers), the problem is solved.<br />
<br />
What I have found is not a simple formula but a collection of cases we have to examine at each step. Where it gets complicated, we might discover an universal system that simplify things.<br />
Instead of simply presenting the solution, this study takes you along its chronological development, but where it is necessary, I go ahead in time or summarize what we have learned to give you a better overview.<br />
<br />
The research required writing a computer program, which I have made available at<br />
github.com/fodorbalint/OneWayLabyrinth</div><div class="num">2</div></td></tr>
<tr><td><div class="border"></div><div>In the beginning, I let it run on a 21 x 21 field, and whenever the line stopped, I coded the solution into it. But soon things got too complex, and I was still far from solving the board. That's where I decided to take a gradual approach.<br />
<br />
A 3 x 3 area can only be filled in two ways, which are mirrored versions of each other:<br />
<br />
<img src="References/3x3.svg" width="14.285714285714%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img src="References/3x3_1.svg" width="14.285714285714%" /><br />
<br />
The 5 x 5 requires much more consideration. Whenever it is possible to draw future lines, the program has to be able to do it. The future lines can not only extend at each step but connect too.<br />
<!-- specify extension and connection rules --><br />
<img src="References/0806.svg" width="23.809523809524%" /><br />
<br />
Using this method, I found the number of walkthroughs to be 104.<br />
Here are the things to consider on a grid of this size:</div><div class="num">3</div></td></tr>
<tr><td><div class="border"></div><div><img src="References/rules/5/C-Shape.svg" width="19.047619047619%" align="top" /><img src="References/spacer.svg" width="4.7619047619048%" /><img src="References/C-Shape example.svg" width="23.809523809524%" align="top" /><br />
<br />
- A single field next to the live end that is walled from two other sides (either by the border or the line) needs to be filled in the next step. I call it C-shape. The pattern is both mirrored and rotated, so that the empty field is straight ahead. To qualify for this rule, the empty field cannot be the end corner. If there is a C-shape, we don't need to check other rules.<br />
<br />
<img src="References/near border.svg" width="23.809523809524%" /><br />
<br />
- Movement near the edge: In the example, we cannot step left (3,5), since the (2,5) field is empty.</div><div class="num">4</div></td></tr>
<tr><td><div class="border"></div><div><img src="References/0821_1.svg" width="23.809523809524%" /><br />
<br />
- A 2 x 3 empty area next to the live end that is walled by three sides (2-3-2 long) will have a future line going through along the walls. At the wall next to the main line, its direction is the opposite of the main line, meaning it will go from (3,2) upwards whereas the main line just took a step downwards. How the middle field will be filled is not yet known. Either the near end (the one the main line will go through first) or the far end can fill it.<br />
<br />
<img src="References/0821_2.svg" width="23.809523809524%" /><br />
<br />
- A 2 x 2 empty area next to the live end that is walled by three sides (2-2-2 long) will have a future line going through along the walls. In this example, the far end is already extended by one step as it had only one option to move.</div><div class="num">5</div></td></tr>
<tr><td><div class="border"></div><div><img src="References/1019_9.svg" width="23.809523809524%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img src="References/1019_10.svg" width="23.809523809524%" /><br />
<br />
- Future line extension when we step on a future line: The far can be extended if it was 2 distance away from the near end. It can now fill the C-shape.<br />
<br />
<img src="References/1021_4.svg" width="23.809523809524%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img src="References/1021_5.svg" width="23.809523809524%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img src="References/1021_6.svg" width="23.809523809524%" /><br />
<br />
The same goes with 1 x- and y-distance. A C-Shape is not always created in this case.<br />
<br />
<img src="References/1019_11.svg" width="23.809523809524%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img src="References/1019_12.svg" width="23.809523809524%" /><br />
<br />
If the far end was near the end corner, it has to choose the other empty field.</div><div class="num">6</div></td></tr>
<tr><td><div class="border"></div><div><img src="References/0821_3.svg" width="23.809523809524%" /><br />
<br />
- Future line extension when stepping away: If there was a near end where the main line was in the previous step, it now may have only one choice to move, so it can be extended.<br />
<br />
<img src="References/future connection.svg" width="23.809523809524%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img src="References/0821_4.svg" width="23.809523809524%" /><br />
<br />
- Future line connection: In this case, the line being stepped on extends until the far end has two options. (When the end corner is one of them, it has to be removed.) Then, the line on the left extends and now has no other option than to connect to the line on the right.<br />
<br />
<img src="References/0930.svg" width="23.809523809524%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img src="References/0930_0_1.svg" width="23.809523809524%" /><br />
<br />
- When we are two distance away from the edge, we need to check if stepping towards it is possible.</div><div class="num">7</div></td></tr>
<tr><td><div class="border"></div><div>It is because if we do so, an enclosed area is created, with one way to go out of it. If that area has an impair amount of cells, it cannot be filled, so we cannot take that step.<br />
The explanation is simple: Imagine if the table was a chess board. In order to step from white to black, you would need to take an impair amount of steps - the color changes at every step. Here, the entry of the area would be (4,3) and the exit (5,3). An impair amount of steps means pair amount of cells.<br />
In the example, you can also say that we cannot step right, because there is a future line start 2 to straight and an end 2 to straight and 2 to right. On 7 x 7, there will be examples where this is the rule we have to apply, because area counting is not getting triggered: <br />
<br />
<img src="References/1001.svg" width="33.333333333333%" /></div><div class="num">8</div></td></tr>
<tr><td><div class="border"></div><div>But let's start with the simpler rules:<br />
<br />
- Future line extension: When a near end is at 2 distance left or right from the live end, it will fill the field between them if the live end steps elsewhere. That's what happened in the 5 x 5 example above before the line failed.<br />
<br />
<img src="References/0911.svg" width="33.333333333333%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img src="References/0911_0_1.svg" width="33.333333333333%" /><br />
<br />
In other situations, there is a 1-thin future line next to the live end that can be extended if its far end is at the corner. Though disabling this rule does not affect the total amount of walkthroughs on a 7 x 7 grid, I chose to include it in the project on the basis that if a future line can be extended, we should do it. It can make a considerable difference. The left picture is without the rule, the right is with it.</div><div class="num">9</div></td></tr>
<tr><td><div class="border"></div><div><img src="References/0901.svg" width="33.333333333333%" /><br />
<br />
- Just like moving near the edge, we need to disable some fields if we are approaching an older section of the main line. In order to determine on which side the enclosed area is created, we need to examine the direction of the line at the connection point.<br />
<br />
<img src="References/checknearfield/close straight left right.svg" width="9.5238095238095%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img src="References/checknearfield/close straight left left.svg" width="14.285714285714%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img src="References/checknearfield/close straight right right.svg" width="14.285714285714%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img src="References/checknearfield/close straight right left.svg" width="9.5238095238095%" /><br />
<br />
The gray square means empty field. When the field 2 to straight is taken, its left or right side will be taken too.<br />
<br />
<img src="References/checknearfield/close mid across right.svg" width="14.285714285714%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img src="References/checknearfield/close mid across left.svg" width="19.047619047619%" /><br />
<br />
These will only be checked if one of the above 4 situations were not present. (They have to be mirrored, too.)</div><div class="num">10</div></td></tr>
<tr><td><div class="border"></div><div><img src="References/checknearfield/close across right.svg" width="19.047619047619%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img src="References/checknearfield/close across left.svg" width="23.809523809524%" /><br />
<br />
Likewise, these will be not be checked if the previous rules were true.<br />
<br />
And when none of the 1-distance situations are valid, we check for 2-distance.<br />
<br />
<img src="References/0929_1.svg" width="33.333333333333%" /><br />
<br />
Impair areas can now happen inside the grid, not just on the edge, and the following rules have to be applied:<br />
<br />
<img src="References/checknearfield/far straight left.svg" width="19.047619047619%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img src="References/checknearfield/far straight right.svg" width="19.047619047619%" /><br />
<br />
The procedure is similar to the the straight 2-distance rule. The only difference is that we count the area starting and ending at the marked fields. In the first, the direction of the circle is left, in the second right.</div><div class="num">11</div></td></tr>
<tr><td><div class="border"></div><div>Besides mirroring them, we also have to rotate them both counter-clockwise and clockwise.<br />
But we do not need 12 of such rules. Taking the first, the live end cannot come from the left, because the area parity was already checked in the previous step, and now we just added 2 fields to it. It can come from the right, and then there is naturally only one field we might have to disable.<br />
Here are the representations of the two scenarios for the left side:<br />
<br />
<img align="top" src="References/checknearfield/far side down.svg" width="19.047619047619%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/checknearfield/far side up.svg" width="19.047619047619%" /><br />
<br />
Similarly to the straight rules, these will only apply if there is no wall 2 distance to the left or right. Let's construct these preconditions.<br />
<br />
<img align="top" src="References/checknearfield/close side straight.svg" width="14.285714285714%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/checknearfield/close side mid across up.svg" width="14.285714285714%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/checknearfield/close side mid across down.svg" width="14.285714285714%" /><br />
<br />
We are not finished. Did you notice the example above is not covered by these rules? We have to move the taken fields 1 and 2 steps to the side, both in straight and side direction.</div><div class="num">12</div></td></tr>
<tr><td><div class="border"></div><div><img align="top" src="References/checknearfield/far mid across left.svg" width="19.047619047619%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/checknearfield/far mid across right.svg" width="23.809523809524%" /><br />
<img src="References/spacer.svg" height="19.047619047619px" /><br />
<img align="top" src="References/checknearfield/far across left.svg" width="23.809523809524%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/checknearfield/far across right_0.svg" width="19.047619047619%" /><br />
<img src="References/spacer.svg" height="19.047619047619px" /><br />
<img align="top" src="References/checknearfield/far side mid across up.svg" width="19.047619047619%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/checknearfield/far side mid across down.svg" width="19.047619047619%" /><br />
<img src="References/spacer.svg" height="19.047619047619px" /><br />
<img align="top" src="References/checknearfield/far side across up.svg" width="19.047619047619%" /></div><div class="num">13</div></td></tr>
<tr><td><div class="border"></div><div>When any of the straight 1-distance rules are present, we don't need to check the side rules or the area created with the border. We can only move within the enclosed area:<br />
<br />
<img src="References/1019_8.svg" width="42.857142857143%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/1021_2.svg" width="42.857142857143%" /><br />
<br />
And these are the rest of the rules:<br />
<br />
<img align="top" src="References/rules/7/Future L.svg" width="19.047619047619%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/Future L 65.svg" width="33.333333333333%" /><br />
<br />
This is what I started the 7 x 7 introduction with. I will call it Future L.</div><div class="num">14</div></td></tr>
<tr><td><div class="border"></div><div><img align="top" src="References/rules/7/Future 2 x 2 Start End.svg" width="28.571428571429%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/Future 2 x 2 Start End 450.svg" width="33.333333333333%" /><br />
<br />
<br />
<img align="top" src="References/rules/7/Future 2 x 3 Start End.svg" width="14.285714285714%" /><img src="References/spacer.svg" width="19.047619047619%" /><img align="top" src="References/Future 2 x 3 Start End 465.svg" width="33.333333333333%" /><br />
<br />
<img align="top" src="References/rules/7/Future 3 x 3 Start End.svg" width="23.809523809524%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/Future 3 x 3 Start End 1861.svg" width="33.333333333333%" /><br />
<br />
And these are the remaining size-specific rules. Future 2 x 2 Start End, Future 2 x 3 Start End and Future 3 x 3 Start End.</div><div class="num">15</div></td></tr>
<tr><td><div class="border"></div><div>The program, in fast mode, can run through approximately 100 cases per second, depending on your computer speed. This enables us to discover all 7 x 7 walkthroughs, which is 111 712.<br />
It is equal to what is described in the Online Encyclopedia of Integer Series (Number of simple Hamiltonian paths connecting opposite corners of a 2n+1 x 2n+1 grid).<br />
<br />
As the sizes grow, it will be impossible to run through all cases with one computer in a reasonable time. In order to discover the patterns, we need to run the program randomly.<br />
<br />
Is it possible to develop an algorithm that works for all sizes? The edge-related and area-counting rules are universal, but the size-specific rules get more and more complex. Can you define them with one statement?<br />
<br />
I have made statistics about how many random walkthroughs you can complete on different grids using the 7 x 7-specific and the universal rules before running into an error. Based on 1000 attempts, here are the results:<br />
<br />
9: 19.5<br />
11: 5.7<br />
13: 2.6<br />
15: 1.2<br />
17: 0.7<br />
19: 0.4<br />
21: 0.2</div><div class="num">16</div></td></tr>
<tr><td><div class="border"></div><div>To discover 9-specific patterns, I run the program keeping it left as long as the time to get to the first error is too big. After that, I will run it randomly. The first 13 826 walkthroughs are completed before we encounter a situation. It is similar to the last one we discovered on 7 x 7:<br />
<br />
<img align="top" src="References/1007.svg" width="42.857142857143%" /></div><div class="num">17</div></td></tr>
<tr><td><div class="border"></div><div>Let's simplify the pattern. Which will be impossible to fill?<br />
<br />
<img align="top" src="References/1008.svg" width="42.857142857143%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/1008_1.svg" width="42.857142857143%" /><br />
<br />
It is the picture on the left. Since the yellow-bordered area is impair, adding the (4,2) (4,3) (4,4) fields will be pair. We enter the area at (4,4), so we will exit at (4,3). Now we enter the 3 x 3 area in the top left corner at its side, (3,3) and will exit at (2,4). The result is two C-shapes on each side:<br />
<br />
<img align="top" src="References/1008_2.svg" width="42.857142857143%" /></div><div class="num">18</div></td></tr>
<tr><td><div class="border"></div><div>We can define a rule by marking the following fields and counting the area from the fields in front of the main line to the right:<br />
<br />
<img align="top" src="References/rules/9_old/Future 3 x 3 Start End 9.svg" width="28.571428571429%" /><br />
<br />
Start_1 field is (4,3) and Start_2 field is (4,4) in the actual example. End field is (4,2). Direction of the circle: right (counter-clockwise). If the area is pair, we cannot step straight.<br />
<br />
When generating code from the drawing, we have to check on which side the enclosed area was created. Here, we want it to be on the right side, so there are two cases to look at:<br />
- The taken or border field beyond the end field is a taken field. In this case, if the field to its left is taken, its index must be lower. If the field to the right is taken, its index must be higher.<br />
- It is the border. Add together the x- and y-coordinates to get a value. A higher value is closer to the end corner. Here, we compare the border field straight ahead and on its left, and we want the first-mentioned to be the smaller.</div><div class="num">19</div></td></tr>
<tr><td><div class="border"></div><div>I have applied this rule rotated clockwise (besides mirroring it, of course), so that the live end can both come from the bottom and the right. But it can also come from the left in this example:<br />
<br />
<img align="top" src="References/1010_2.svg" width="42.857142857143%" /><br />
<br />
This will probably be another rule, because in this case it is not necessary to have an empty 3 x 3 field on the left.</div><div class="num">20</div></td></tr>
<tr><td><div class="border"></div><div>Now let's run the program further up to number 13 992:<!-- (from stepping back + 142 (with first rule disabled) / 158 = 13 984) why? --><br />
<br />
<img align="top" src="References/1010_4_error.svg" width="42.857142857143%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/1010_4.svg" width="42.857142857143%" /><br />
<br />
It is also just like the 7 x 7 rule, just with the extension of the area on the opposite side of the future line ends. But we can't simply remove the two taken fields on that side, because the line might continue in that direction, as it is the case here:<br />
<br />
<img align="top" src="References/1013.svg" width="33.333333333333%" /><br />
<br />
It would be a mistake to disable the right field.</div><div class="num">21</div></td></tr>
<tr><td><div class="border"></div><div>So we need to check if an enclosed has been created on that side, but counting the area is unnecessary. Nevertheless, we can represent the rule this way, setting the circle direction to right:<br />
<br />
<img align="top" src="References/rules/9_old/Future 2 x 2 Start End 9.svg" width="23.809523809524%" /><br />
<br />
The code generator will examine if the count area start and end fields are 1 or 2 distance apart. In the first case, it will only determine in which direction the taken field straight ahead is going to, and if it is right, the forbidden field will take effect.<br />
You may ask, why that field is "taken", not "taken or border". From what I found through some examples, if that field is border, the enclosed area on the right is impair, so the line cannot step in the other direction anyway. But it needs further examination.</div><div class="num">22</div></td></tr>
<tr><td><div class="border"></div><div>The next error, at 14 004 has something to with how I defined the universal rules of approaching an older section of the line, it needs to be reworked in light of the C-shape the main line can create with the border.<br />
<br />
<img align="top" src="References/1013_1.svg" width="42.857142857143%" /><br />
<br />
We need to take a few steps back, and then we can create the rule. It is similar to the universal 2-distance rule on the side, it just checks the field 2 behind and 1 to the side too. Even though the area counted is pair, now stepping to the right is disabled.<br />
<br />
<img align="top" src="References/rules/9_old/Future 2 x 3 Start End 9.svg" width="19.047619047619%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/1013_2.svg" width="42.857142857143%" /></div><div class="num">23</div></td></tr>
<tr><td><div class="border"></div><div>At 55 298, we get this:<br />
<br />
<img align="top" src="References/1022.svg" width="42.857142857143%" /><br />
<br />
Let's analyze it! A double C-shape is created, because the line occupied the A field, and out of the B, C and D fields it exited the right-side area at C. It means, the area enclosed by the marked fields is pair. In this case, we shouldn't step right and the rule will therefore look like:<br />
<br />
<img align="top" src="References/Double C-Shape orig.svg" width="19.047619047619%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/1022_1.svg" width="42.857142857143%" /><br />
<br />
But what if from the A position, we step upwards in another situation?</div><div class="num">24</div></td></tr>
<tr><td><div class="border"></div><div>Compare these two on 11 x 11:<br />
<br />
<img align="top" src="References/1022_2.svg" width="52.380952380952%" /><br />
<img src="References/spacer.svg" height="19.047619047619px" /><br />
<img align="top" src="References/1022_3.svg" width="52.380952380952%" /><br />
<br />
If the area we started with is pair, then the other will be impair. We can only enter the area at the light-gray field and will exit at A. From there we must go through B, C and D, and then a double C-shape is again created.</div><div class="num">25</div></td></tr>
<tr><td><div class="border"></div><div>One certain situation reveals the incorrectness of the 7-rules when it comes to a 9-grid. In the following example, when I apply a rule rotated, it will disable a field that would otherwise be viable.<br />
<br />
<img align="top" src="References/Future 2 x 2 Start End rotated.svg" width="19.047619047619%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/1027.svg" width="42.857142857143%" /><br />
<br />
Rotating was not necessary to start with on 7 x 7, because no such situation occurred.</div><div class="num">26</div></td></tr>
<tr><td><div class="border"></div><div>We can see that defining a rule with future line starts and ends does not tell us on which side the future line was created. That is the side that contains the enclosed area. We need to therefore replace such rules with area counting, which we actually already did, with the exception of Future L. Here the future line couldn't have been created on the other side, because that's the side the live end is at right now. And area counting is not always possible, like in this situation:<br />
<br />
<img align="top" src="References/1031.svg" width="61.904761904762%" /></div><div class="num">27</div></td></tr>
<tr><td><div class="border"></div><div>As we run the program further, we will discover this at 227 200:<br />
<br />
<img align="top" src="References/227200.svg" width="42.857142857143%" /><br />
<br />
Intuitively, we can draw up the square, and let's mark the exit as well. There can be loops on the upper, lower and right side, they have no importance when tracing it back to the live end. There is only one way to go through.<br />
<br />
<img align="top" src="References/Square 4 x 2 orig.svg" width="23.809523809524%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/227200_1.svg" width="42.857142857143%" /></div><div class="num">28</div></td></tr>
<tr><td><div class="border"></div><div>233 810 will look like:<br />
<br />
<img align="top" src="References/233810.svg" width="42.857142857143%" /><br />
<br />
Once we step to A, it is unavoidable to get to B before entering the outlined area. It is because we can only reach B from the left or the bottom.<br />
The area is impair, therefore we cannot complete it starting in C and ending in D.<br />
If we omit the C field from the area, the area becomes pair. It is clear that the start and end field being across each other, a pair amount of fields cannot be filled. We must therefore enter the area now.<br />
<br />
<img align="top" src="References/rules/9_old/Count Area 2 Across.svg" width="23.809523809524%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/233810_1.svg" width="42.857142857143%" /></div><div class="num">29</div></td></tr>
<tr><td><div class="border"></div><div>234 256 has at first sight something to do with future lines.<br />
<br />
<img align="top" src="References/234256.svg" width="42.857142857143%" /><br />
<br />
But it is more than that. Notice that enclosed areas has been created on both sides simultaneously. Because of the universal rules for approaching an older section of the line, now we have no option to move. The areas can be filled individually, but we cannot step to left and right at the same time.<br />
We have to create 2-distance rules, which take both sides into account.<br />
<br />
<img align="top" src="References/checknearfield/2 far mid across across.svg" width="28.571428571429%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/checknearfield/2 far side mid across across down.svg" width="19.047619047619%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/checknearfield/2 far side mid across across up.svg" width="19.047619047619%" /><br />
<br />
These are just a few of the possible combinations.</div><div class="num">30</div></td></tr>
<tr><td><div class="border"></div><div>Any of the far straight rules (straight, mid across and across as I call them, depending on the horizontal distance of the obstacle) on the left side can be combined with any of those on the right side when the enclosed area is going to the same direction - left for left side and right for right side.<br />
And the same is true when the pattern is rotated to the left or right side.<br />
As far as porgramming concerned, it just needed a rework of the universal rules, we didn't need to make completely new ones.</div><div class="num">31</div></td></tr>
<tr><td><div class="border"></div><div>At 349 215, we find this:<br />
<br />
<img align="top" src="References/349215.svg" width="42.857142857143%" /><br />
<br />
Though a double C-shape has been created in backwards direction, it indicates that the area on the right cannot be filled either.<br />
We have made a similar rule previously. Now we need to simplify it.<br />
<br />
<img align="top" src="References/Double C-Shape orig.svg" width="19.047619047619%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/rules/9_old/Double C-Shape.svg" width="14.285714285714%" /><br />
<br />
The area now has to be impair for the right direction to be forbidden. Essentially, we just added the three extra fields to the pair area.</div><div class="num">32</div></td></tr>
<tr><td><div class="border"></div><div>478 361 is similar to what we have seen before, only now there is a 2-wide path to exit the area:<br />
<br />
<img align="top" src="References/478361.svg" width="42.857142857143%" /><br />
<br />
We have to mark where the area has been created in another way.<br />
<br />
<img align="top" src="References/Square 4 x 2 orig.svg" width="23.809523809524%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/rules/9_old/Square 4 x 2.svg" width="19.047619047619%" /><br />
<br />
The taken field in the upper right corner is now checked for direction, but it is not enough. It can go upwards, and the exit of the area can still be on the bottom edge, just look at the example and imagine the live end was at A with the pattern already drawn. (On 11 x 11, it is possible to draw it.)<br />
In order to establish an enclosed area, we must not encounter the bottom-right corner of the grid when walking along the edge of it.</div><div class="num">33</div></td></tr>
<tr><td><div class="border"></div><div>626 071 is:<br />
<br />
<img align="top" src="References/626071.svg" width="42.857142857143%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/626071_1.svg" width="42.857142857143%" /><br />
<br />
With the marked area being pair, if we enter the area by stepping left, we will exit at A. But we can only get there from B; if we entered from the top, nothing would fill B, and we cannot enter and exit it after we left the area - subtracting 1 from the area would make it impair, so then we couldn't have exited at A.<br />
The taken field C creates a C-shape, which we need to step into from B.</div><div class="num">34</div></td></tr>
<tr><td><div class="border"></div><div>The universal far across rule have to be extended. By default, we disable the option to step straight or right if the counted area is impair. When it is pair, we need to disable the left field.<br />
<br />
<img align="bottom" src="References/checknearfield/far across left.svg" width="23.809523809524%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="bottom" src="References/checknearfield/far across left end C.svg" width="23.809523809524%" /><br />
<img src="References/spacer.svg" height="19.047619047619px" /><br />
<img align="bottom" src="References/checknearfield/far side across up.svg" width="19.047619047619%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="bottom" src="References/checknearfield/far side across up end C.svg" width="23.809523809524%" /><br />
<br />
The same concept we encounter at 635 301, only the C-shape is created when we enter an area, on the other side of it.<br />
<br />
<img align="top" src="References/635301.svg" width="42.857142857143%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/635301_1.svg" width="42.857142857143%" /></div><div class="num">35</div></td></tr>
<tr><td><div class="border"></div><div>We have seen this in the third 9 x 9 rule. There the taken field next to the exit was in middle across position, and now it is across. And we also need to think about an obstacle straight ahead. Here are the original universal rules and their modifications.<br />
Straight, circle direction left:<br />
<br />
<img src="References/checknearfield/far straight left.svg" width="19.047619047619%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img src="References/checknearfield/far straight left start C.svg" width="23.809523809524%" /><br />
<img src="References/spacer.svg" height="19.047619047619px" /><br />
<img src="References/checknearfield/far mid across left.svg" width="19.047619047619%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img src="References/checknearfield/far mid across left start C.svg" width="23.809523809524%" /><br />
<img src="References/spacer.svg" height="19.047619047619px" /><br />
<img src="References/checknearfield/far across left.svg" width="23.809523809524%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img src="References/checknearfield/far across left start C.svg" width="28.571428571429%" /></div><div class="num">36</div></td></tr>
<tr><td><div class="border"></div><div>Circle direction right:<br />
<br />
<img src="References/checknearfield/far straight right.svg" width="19.047619047619%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img src="References/checknearfield/far straight right start C.svg" width="23.809523809524%" /><br />
<img src="References/spacer.svg" height="19.047619047619px" /><br />
<img src="References/checknearfield/far mid across right.svg" width="23.809523809524%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img src="References/checknearfield/far mid across right start C.svg" width="23.809523809524%" /><br />
<img src="References/spacer.svg" height="19.047619047619px" /><br />
<img src="References/checknearfield/far across right.svg" width="28.571428571429%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img src="References/checknearfield/far across right start C.svg" width="28.571428571429%" /><br />
<br />
Side, with taken fields above and below:<br />
<br />
<img src="References/checknearfield/far side up.svg" align="top" width="19.047619047619%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img src="References/checknearfield/far side up start C.svg" align="top" width="19.047619047619%" /><br />
<img src="References/spacer.svg" height="19.047619047619px" /><br />
<img src="References/checknearfield/far side down.svg" align="top" width="19.047619047619%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img src="References/checknearfield/far side down start C.svg" align="top" width="19.047619047619%" /></div><div class="num">37</div></td></tr>
<tr><td><div class="border"></div><div><img src="References/checknearfield/far side mid across up.svg" align="top" width="19.047619047619%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img src="References/checknearfield/far side mid across up start C.svg" align="top" width="19.047619047619%" /><br />
<img src="References/spacer.svg" height="19.047619047619px" /><br />
<img src="References/checknearfield/far side mid across down.svg" align="top" width="19.047619047619%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img src="References/checknearfield/far side mid across down start C.svg" align="top" width="19.047619047619%" /><br />
<img src="References/spacer.svg" height="19.047619047619px" /><br />
<img src="References/checknearfield/far side across up.svg" align="top" width="19.047619047619%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img src="References/checknearfield/far side across up start C.svg" align="top" width="19.047619047619%" /><br />
<img src="References/spacer.svg" height="19.047619047619px" /><br />
<img src="References/checknearfield/far side across down.svg" align="bottom" width="19.047619047619%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img src="References/checknearfield/far side across down start C.svg" align="bottom" width="19.047619047619%" /><br />
<br />
I have made some changes by adding some empty fields in side positions, so they are the same as the straight rules, just rotated.<br />
Also, I have added the side across down rule and changed the straight across rule accordingly. Not only fields next to each other can define an area, they can be across too. In that case, if the area originally was marked impair, now it has to be pair.</div><div class="num">38</div></td></tr>
<tr><td><div class="border"></div><div>Notice that in side rules, when the taken field that would create the C-shape is below the obstacle creating the area, it can be a border field too. We have seen an example of that previously.<br />
<br />
Now what if both the start and end C-conditions are true? We can construct this on 13 x 13:<br />
<br />
<img align="top" src="References/1119.svg" width="61.904761904762%" /><br />
<br />
Several walkthrough attempts will leave you thinking why you cannot fill the area once obstacle responsible for the start C-shape is created (A). The area enclosed by A, B and C is pair. So when you enter it at A or B (obviously C is not a possibility), in order to exit at C, you need to leave out an impair amount of fields from the area. In case of entering at B, you cannot leave out A, but when you enter at A, you can leave out B, and no more than that. Now the area will be impair.</div><div class="num">39</div></td></tr>
<tr><td><div class="border"></div><div>The minimal area would be stepping left from A, left again, up and up to get to C. You have covered 5 fields.<br />
In order to make a walkthroughable area, you would need to extend it by pairs of fields next to each other, like D and E. One will be filled at a pair amount of steps, the other at an impair amount.<br />
<br />
Let's mark the original example as a checkerboard.<br />
<br />
<img align="top" src="References/1119_2.svg" width="61.904761904762%" /><br />
<br />
We enter at a black field and exit at black too, so the number of black fields should be one more than the number of white fields.<br />
Here there are 14 black fields and 15 white. That's why the area cannot be filled. The up and right directions need to be disabled, so we can only step left.</div><div class="num">40</div></td></tr>
<tr><td><div class="border"></div><div>This is the rule representation. The reddish arealine now means the arealine is impair, and we know that the entry and exit points are the arealine start and end fields.<br />
<br />
<img align="top" src="References/rules/13_old/Across 3 impair determined.svg" width="28.571428571429%" /><br />
<br />
And now the walkthrough is possible.<br />
<br />
<img align="top" src="References/1119_3.svg" width="61.904761904762%" /></div><div class="num">41</div></td></tr>
<tr><td><div class="border"></div><div>Continuing the 9 x 9 program, we get this at 641 019:<br />
<br />
<img align="top" src="References/641019.svg" width="42.857142857143%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/641019_1.svg" width="42.857142857143%" /><br />
<br />
If you enter the pair area straight ahead, you will exit at A, and you need to turn towards B because of the C-shape. Now you cannot go in and out of the area enclosed by C, and the situation would be the same if that obstacle was in D. <br />
<br />
To mark the two areas, each one has to be given a directional obstacle next to the count area end field. In this case, it represents a taken field, but we don't go wrong if we include the border as well.<br />
<br />
<img align="top" src="References/rules/9_old/Double Area C-Shape.svg" width="23.809523809524%" /><br />
<br />
And with this marking system, we can correct the rules previously made. All rules featuring future line start and end fields have to be rewritten to start with.</div><div class="num">42</div></td></tr>
<tr><td><div class="border"></div><div>So we get the 2-distance across rule, the straight 3-distance rule to prevent a double C-shape, and the square constellation with 3 areas. All of them are rotated clockwise or counter-clockwise.<br />
<br />
<img align="top" src="References/rules/9_old/Count Area 2 Across.svg" width="23.809523809524%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/rules/9_old/Double C-Shape rotated.svg" width="28.571428571429%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/rules/9_old/Square 4 x 2_2.svg" width="19.047619047619%" /><br />
<br />
Let's return to the last example and make a modification:<br />
<br />
<img align="top" src="References/641019_2.svg" width="42.857142857143%" /><br />
<br />
The field previously marked with B is now empty. But we still need to step in that direction, due to the area enclosed by A, which obstacle could as well be in B.</div><div class="num">43</div></td></tr>
<tr><td><div class="border"></div><div>The rule will be now symmetrical. It is similar to the square obstacle pattern.<br />
<br />
<img align="top" src="References/rules/9_old/Triple Area.svg" width="23.809523809524%" /><br />
<br />
The same concept we encounter at 725 325. We have seen this previously, just with C-shape, not an area.<br />
<br />
<img align="top" src="References/725325_1.svg" width="42.857142857143%" /><br />
<br />
The rule is now:<br />
<br />
<img align="top" src="References/rules/9_old/Straight Across End Area.svg" width="19.047619047619%" /></div><div class="num">44</div></td></tr>
<tr><td><div class="border"></div><div>740 039 is a slight modification.<br />
<br />
<img align="top" src="References/740039.svg" width="42.857142857143%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/740039_1.svg" width="42.857142857143%" /><br />
<br />
The only difference is, that the obstacle is 3-distance away. With the area being impair, if we enter at A, we must exit at C.<br />
What if we omit D from the area? Then the area will be pair, so we must exit at B, and the only way to get there is from C. And if D is included, we can only step to C from there. Either way, we step away from the area beyond D, so the rule will be:<br />
<br />
<img align="top" src="References/rules/9_old/Straight Across 3 End Area.svg" width="19.047619047619%" /></div><div class="num">45</div></td></tr>
<tr><td><div class="border"></div><div>811 808:<br />
<br />
<img align="top" src="References/811808.svg" width="42.857142857143%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/811808_1.svg" width="42.857142857143%" /><br />
<br />
Recognize it is a variation of the square obstacle pattern where instead of an area, there is a C-shape at the rule's upper edge. <br />
<br />
<img align="top" src="References/rules/9_old/Square 4 x 2 C-Shape.svg" width="23.809523809524%" /></div><div class="num">46</div></td></tr>
<tr><td><div class="border"></div><div>1 261 580:<br />
<br />
<img align="top" src="References/1261580.svg" width="42.857142857143%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/1261580_1.svg" width="42.857142857143%" /><br />
<br />
Again, same pattern with area. The upper obstacle is now moved, but it will satisfy the previous examples too. The rule replaces the old one.<br />
<br />
<img align="top" src="References/rules/9_old/Square 4 x 2 Area.svg" width="23.809523809524%" /></div><div class="num">47</div></td></tr>
<tr><td><div class="border"></div><div>2 022 337 is getting stuck because of the stair-shaped walls that force the future line along them. Therefore, an area is created with only one field to go in and out of it. What is the solution?<br />
<br />
<img align="top" src="References/2022337.svg" width="42.857142857143%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/2022337_1.svg" width="42.857142857143%" /><br />
<br />
Though not as universal as we want it to be, this will solve this specific situation:<br />
<br />
<img align="top" src="References/rules/9_old/Double Area Stair.svg" width="33.333333333333%" /></div><div class="num">48</div></td></tr>
<tr><td><div class="border"></div><div>And soon, at 2 022 773 we encounter a similar one:<br />
<br />
<img align="top" src="References/2022773.svg" width="42.857142857143%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/2022773_1.svg" width="42.857142857143%" /><br />
<img src="References/spacer.svg" height="19.047619047619px" /><br />
<img align="top" src="References/rules/9_old/Double Area Stair 2.svg" width="23.809523809524%" /></div><div class="num">49</div></td></tr>
<tr><td><div class="border"></div><div>On 17 x 17, we can construct a situation where the obstacle across the stair is 2 behind and 2 to right. As the table size increases, the stair-obstacle narrowing can move infinite distance away from the live end. That's why it is important to group these rules as one.<br />
<br />
<img align="top" src="References/1218_1.svg" width="80.952380952381%" /></div><div class="num">50</div></td></tr>
<tr><td><div class="border"></div><div>We have all the tools to handle 2 034 575.<br />
<br />
<img align="top" src="References/2034575.svg" width="42.857142857143%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/2034575_1.svg" width="42.857142857143%" /><br />
<br />
It is an impair area where the number of the starting field's color is less than the other color.<br />
<br />
<img align="top" src="References/rules/9_old/Mid Across 3 Impair Determined.svg" width="19.047619047619%" /></div><div class="num">51</div></td></tr>
<tr><td><div class="border"></div><div>Next stop is at 3 224 847.<br />
<br />
<img align="top" src="References/3224847.svg" width="42.857142857143%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/3224847_1.svg" width="42.857142857143%" /><br />
<br />
A pair area is created with the obstacle 3 distance away, so if we step into it, we will exit at the middle, but because of an area, we cannot step there.<br />
<br />
<img align="top" src="References/rules/9_old/Straight Mid Across 3 End Area.svg" width="19.047619047619%" /><br />
<br />
Should the left field be disabled too? Yes. We still have to exit at the middle, but the count area start and end field cannot be filled simultaneously.</div><div class="num">52</div></td></tr>
<tr><td><div class="border"></div><div>From our experience, the area can be substituted with C-shape.<br />
<br />
<img align="top" src="References/1219.svg" width="52.380952380952%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/rules/9_old/Straight Mid Across 3 End C.svg" width="9.5238095238095%" /><br />
<br />
3 225 432 is a variation of the impair area imbalance rules we have seen before.<br />
<br />
<img align="top" src="References/3225432.svg" width="42.857142857143%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/3225432_1.svg" width="42.857142857143%" /><br />
<img src="References/spacer.svg" height="19.047619047619px" /><br />
<img align="top" src="References/rules/9_old/Mid Mid Across 3 Determined.svg" width="23.809523809524%" /></div><div class="num">53</div></td></tr>
<tr><td><div class="border"></div><div>8 076 012 builds upon the existing rule where C-shapes are created on both sides if we enter an impair area.<br />
<br />
<img align="top" src="References/8076012.svg" width="42.857142857143%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/8076012_1.svg" width="42.857142857143%" /><br />
<br />
Here, a C-shape at the start would force the line to enter the area.<br />
<br />
<img align="top" src="References/rules/9_old/Double C-Shape Start C.svg" width="14.285714285714%" /></div><div class="num">54</div></td></tr>
<tr><td><div class="border"></div><div>Soon we get a similar situation, only here it is the imbalance of pair and impair fields that is to blame.<br />
<br />
<img align="top" src="References/8076044.svg" width="42.857142857143%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/8076044_1.svg" width="42.857142857143%" /><br />
<br />
If we step to A, we cannot step left and therefure must continue to B (or right). From B, the only possibility is C, but the 5 x 3 area is not just impair, there is less of the C-parity field than the other.<br />
In the rule, I introduced a new field that indicates the entry point; this has always been the start field until now.<br />
<br />
<img align="top" src="References/rules/9_old/Double C-Shape Determined.svg" width="14.285714285714%" /></div><div class="num">55</div></td></tr>
<tr><td><div class="border"></div><div>At 19 717 655 the program stops.<br />
<br />
<img align="top" src="References/19717655.svg" width="42.857142857143%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/19717655_1.svg" width="42.857142857143%" /><br />
<br />
Obvously, we cannot step straight, but had we extended the future line until the end corner, the situation would not have occurred and we would have just got this:<br />
<br />
<img align="top" src="References/19717655_2.svg" width="42.857142857143%" /><br />
<br />
Though the algorithm including the reliance on the future lines is just as solvable, we miss patterns and therefore narrow the spectrum of the discoverable rules. We would eventually discover the patterns as we increase the table, but why not gain the most out of the 9 x 9 study?</div><div class="num">56</div></td></tr>
<tr><td><div class="border"></div><div>From now on, future lines are treated as a visible aid, but they do not play a role in deciding which fields are available for the next move. When a possible field is within the body of a future line, the program should stop. <br />
<br />
<img align="top" src="References/19717655_3.svg" width="42.857142857143%" /><br />
<br />
It is not the only thing. So far, when we entered a future line, the program just followed it without checking the possibilities for the next step.<br />
This behaviour needs to be changed too. Future lines are no longer needed, and we should restart the 9 x 9 walkthroughs.<br />
<br />
For now, here is the solution to this and the next cases:<br />
<br />
<img align="top" src="References/rules/9_old/Triple Area Stair.svg" width="33.333333333333%" /></div><div class="num">57</div></td></tr>
<tr><td><div class="border"></div><div>19 718 148 is a slight modification of 2 022 773 where there is an area instead of a C-shape straight ahead.<br />
<br />
<img align="top" src="References/19718148.svg" width="42.857142857143%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/19718148_1.svg" width="42.857142857143%" /><br />
<img src="References/spacer.svg" height="19.047619047619px" /><br />
<img align="top" src="References/rules/9_old/Double Area Stair 2.svg" width="23.809523809524%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/rules/9_old/Double Area Stair Area.svg" width="23.809523809524%" /><br />
<br />
We encounter a new constellation of 3 areas in 23 310 321 where the exit is next to the live end.<br />
<br />
<img align="top" src="References/23310321.svg" width="42.857142857143%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/23310321_1.svg" width="42.857142857143%" /></div><div class="num">58</div></td></tr>
<tr><td><div class="border"></div><div>The two empty fields in the middle will not be filled if we the don't enter the impair area now.<br />
<br />
<img align="top" src="References/rules/9/Triple Area Exit Down.svg" width="28.571428571429%" /><br />
<br />
When restarting the run with the new approach, we will find that some walkthroughs were missed previously. The 10 000 th path is slightly younger than before. It is not because the future lines had been drawn incorrecty, but because the 7 x 7 rules that I used in the beginning were not precise for this size.<br />
In the following section, I list the 9 x 9 rules in chronological order. The patterns are not introduced when they are first recognized, but when they are first needed, meaning that they disable fields that the other rules don't. And the disabled fields have to be empty.<br />
Still, the number of completed walkthroughs before the appereance of the rule may not be the same as the number of those before getting stuck in the lack of that rule. If the rule disables a field right to a possible field, the left branch would run through first.</div><div class="num">59</div></td></tr>
<tr><td><div class="border"></div><div>462, Double Area C-Shape <br />
<br />
<img align="top" src="References/462.svg" width="42.857142857143%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/rules/9_old/Double Area C-Shape.svg" width="23.809523809524%" /><br />
<br />
1 861, Double C-Shape<br />
<br />
<img align="top" src="References/1861.svg" width="42.857142857143%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/rules/9_old/Double C-Shape rotated.svg" width="28.571428571429%" /></div><div class="num">60</div></td></tr>
<tr><td><div class="border"></div><div>9 121, Count Area 2 Across<br />
<br />
<img align="top" src="References/9121.svg" width="42.857142857143%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/rules/9_old/Count Area 2 Across.svg" width="23.809523809524%" /><br />
<br />
22 328, Straight Mid Across 3 End Area<br />
<br />
<img align="top" src="References/22328.svg" width="42.857142857143%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/rules/9_old/Straight Mid Across 3 End Area.svg" width="19.047619047619%" /></div><div class="num">61</div></td></tr>
<tr><td><div class="border"></div><div>22 328, Straight Across End Area<br />
<br />
<img align="top" src="References/22328_1.svg" width="42.857142857143%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/rules/9_old/Straight Across End Area.svg" width="19.047619047619%" /><br />
<br />
25 153, Straight Across End C<br />
<br />
<img align="top" src="References/25153.svg" width="42.857142857143%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/rules/9_old/Straight Across End C.svg" width="14.285714285714%" /></div><div class="num">62</div></td></tr>
<tr><td><div class="border"></div><div>227 130, Square 4 x 2 C-Shape <br />
<br />
<img align="top" src="References/227130.svg" width="42.857142857143%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/rules/9_old/Square 4 x 2 C-Shape.svg" width="23.809523809524%" /><br />
<br />
231 960, Square 4 x 2 Area<br />
<br />
<img align="top" src="References/231960.svg" width="42.857142857143%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/rules/9_old/Square 4 x 2 Area.svg" width="23.809523809524%" /></div><div class="num">63</div></td></tr>
<tr><td><div class="border"></div><div>740 129, Straight Across 3 End Area <br />
<br />
<img align="top" src="References/740129.svg" width="42.857142857143%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/rules/9_old/Straight Across 3 End Area.svg" width="19.047619047619%" /><br />
<br />
740 363, Triple Area<br />
<br />
<img align="top" src="References/740363.svg" width="42.857142857143%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/rules/9_old/Triple Area.svg" width="23.809523809524%" /></div><div class="num">64</div></td></tr>
<tr><td><div class="border"></div><div>2 022 763, Double Area Stair<br />
<br />
<img align="top" src="References/2022763.svg" width="42.857142857143%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/rules/9_old/Double Area Stair.svg" width="33.333333333333%" /><br />
<br />
2 023 198, Double Area Stair 2<br />
<br />
<img align="top" src="References/2023198.svg" width="42.857142857143%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/rules/9_old/Double Area Stair 2.svg" width="23.809523809524%" /></div><div class="num">65</div></td></tr>
<tr><td><div class="border"></div><div>2 034 435, Mid Mid Across 3 Determined (and Mid Across 3 Impair Determined)<br />
<br />
<img align="top" src="References/2034435.svg" width="42.857142857143%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/rules/9_old/Mid Mid Across 3 Determined.svg" width="23.809523809524%" /><br />
<br />
2 059 934, Mid Across 3 Impair Determined<br />
<br />
<img align="top" src="References/2059934.svg" width="42.857142857143%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/rules/9_old/Mid Across 3 Impair Determined.svg" width="19.047619047619%" /></div><div class="num">66</div></td></tr>
<tr><td><div class="border"></div><div>8 076 202, Straight Mid Across 3 End C<br />
<br />
<img align="top" src="References/8076202.svg" width="42.857142857143%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/rules/9_old/Straight Mid Across 3 End C.svg" width="9.5238095238095%" /><br />
<br />
8 076 706, Double C-Shape Start C<br />
<br />
<img align="top" src="References/8076706.svg" width="42.857142857143%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/rules/9_old/Double C-Shape Start C.svg" width="14.285714285714%" /></div><div class="num">67</div></td></tr>
<tr><td><div class="border"></div><div>8 076 762, Double C-Shape Determined<br />
<br />
<img align="top" src="References/8076762.svg" width="42.857142857143%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/rules/9_old/Double C-Shape Determined.svg" width="14.285714285714%" /><br />
<br />
18 665 383, Triple Area Exit Down<br />
<br />
<img align="top" src="References/18665383.svg" width="42.857142857143%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/rules/9/Triple Area Exit Down.svg" width="28.571428571429%" /></div><div class="num">68</div></td></tr>
<tr><td><div class="border"></div><div>19 720 122, Triple Area Stair<br />
<br />
<img align="top" src="References/19720122.svg" width="42.857142857143%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/rules/9_old/Triple Area Stair.svg" width="33.333333333333%" /><br />
<br />
19 720 614, Double Area Stair Area<br />
<br />
<img align="top" src="References/19720614.svg" width="42.857142857143%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/rules/9_old/Double Area Stair Area.svg" width="23.809523809524%" /></div><div class="num">69</div></td></tr>
<tr><td><div class="border"></div><div>23 350 320 is new, but it shows similarity to the Mid Across 3 Impair Determined rule. As the double C-shape reveals, it is about pair/impair field imbalance.<br />
<br />
<img align="top" src="References/23350320.svg" width="42.857142857143%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/23350320_1.svg" width="42.857142857143%" /><br />
<img src="References/spacer.svg" height="19.047619047619px" /><br />
<img align="top" src="References/rules/9_old/Mid Across 3 Impair Determined.svg" width="19.047619047619%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/rules/9_old/Mid Across 3 Impair Determined 2.svg" width="14.285714285714%" /><br />
<br />
If we step left in the impair area, we can only exit at the count area middle field, but there is one less field of that type than the other.<br />
And no fields can be omitted from the area for entry and exit later.<br />
When the count area start field + middle field is omitted (subtracting a pair amount of cells from the area), the possible exit is the count area end field, which has a different parity than the field to the left.<br />
When the count area middle + end field is omitted, the possible exit is the count area start field, which has again different parity.</div><div class="num">70</div></td></tr>
<tr><td><div class="border"></div><div>By now, we are able to group some rules and even solve the original 21 x 21 example. Previously, we have covered all of the cases where an obstacle is 2 distance away from the live end. Let's examine distances of 3, 4 and so on in this constellation:<br />
<br />
<img align="top" src="References/3pair.svg" width="23.809523809524%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/4pair.svg" width="28.571428571429%" /><br />
<br />
Besides the count area fields being empty, here I also assume that the left field and the field below the obstacle is also empty. In the future, this might have to be changed and new constellations added.<br />
Knowing the difference between the number of pair and impair fields, we can make a decision in some cases.<br />
<br />
Let's start with this:<br />
<br />
<img align="top" src="References/0101.svg" width="42.857142857143%" /><br />
<br />
The distance is 3, the area is pair, and the number of pair and impair fields are the same. We can either enter the area now (stepping left) or later (up or right).</div><div class="num">71</div></td></tr>
<tr><td><div class="border"></div><div>Either way, we can start and end the area on a different color, so nothing should be disabled.<br />
<br />
<img align="top" src="References/0101_1.svg" width="61.904761904762%" /><br />
<br />
Here, the area is still pair, but there are 12 black fields and 10 white.<br />
To fill it, two lines of an impair length would be needed, each starting and finishing on a black field. Now, it is possible to enter and exit the black field in the upper left corner of the area, but we cannot do it with the field 2 below. And there are no more black fields on the boundary of the area. Filling it is therefore impossible.</div><div class="num">72</div></td></tr>
<tr><td><div class="border"></div><div><img align="top" src="References/0116_1.svg" width="52.380952380952%" /><br />
<br />
When there is one more black field than white (8 and 7 in this case), the area is impair. If we enter now, we can exit at the count area end (to make a line of pair length), and the corner black can be filled later. We can also enter at the corner black later to exit at the couunt area end.</div><div class="num">73</div></td></tr>
<tr><td><div class="border"></div><div><img align="top" src="References/0116_2.svg" width="71.428571428571%" /><br />
<br />
Here, there is one more white field than black. To fill the area, 1 line of impair length would be needed that starts and ends on white, but if the enter the area now, the corner black could not have been filled. Now there are 2 less black fields available for the rest of the area, but making two lines starting and ending on white is impossible, there are not that many white fields on the boundary.<br />
Needless to say that we cannot enter later either, there is only one white field on the boundary.<br />
<br />
If there are even fewer black fields relative to the white, the situation is the same.</div><div class="num">74</div></td></tr>
<tr><td><div class="border"></div><div>At 4 distance (and in any case), we still don't have a problem filling an area that has equal number of black and white fields.<br />
When the number of black fields are two more than the whites (16 and 14):<br />
<br />
<img align="top" src="References/0107.svg" width="61.904761904762%" /><br />
<br />
Two black to black lines would be needed to fill the area. Apart from the black in the corner, there is only one black field on the boundary.</div><div class="num">75</div></td></tr>
<tr><td><div class="border"></div><div>If black = white + 1:<br />
<br />
<img align="top" src="References/0116.svg" width="61.904761904762%" /><br />
<br />
If we enter now by stepping left, there will have to be one more line even if we exit on black. That line has to go from black to black, so it can only be the corner field. Have we exited at the other black field (the third on the boundary), either the second or the fourth could not have been filled.<br />
<b>This direction therefore has to be disabled.</b><br />
We can enter later without problems to start at the corner field, then the second, go inside the area and end at the third.</div><div class="num">76</div></td></tr>
<tr><td><div class="border"></div><div>If black = white - 1:<br />
<br />
<img align="top" src="References/0116_3.svg" width="52.380952380952%" /><br />
<br />
A line that starts and ends on white can be drawn, no matter if we enter now or later. If we enter now, the next field has to be the corner black, and then there will be a line between the two white fields on the boundary.</div><div class="num">77</div></td></tr>
<tr><td><div class="border"></div><div>If black = white - 2:<br />
<br />
<img align="top" src="References/0116_4.svg" width="71.428571428571%" /><br />
<br />
Two white to white lines would be needed, but there are only 3 white fields on the boundary, and none is the corner.<br />
<br />
Without finding concrete examples, at 5 distance I only draw the boundary and go through the different possibilities.</div><div class="num">78</div></td></tr>
<tr><td><div class="border"></div><div><img align="top" src="References/5dist.svg" width="33.333333333333%" /><br />
<br />
<b>black = white + 2</b><br />
<br />
If we enter now and finish at black, only two black fields remain. Drawing two black to black lines is not possible, so this direction has to be disabled.<br />
We can enter later, go through the corner and draw another black to black line.<br />
<br />
black = white + 3<br />
<br />
There is not enough black fields for three black to black lines.<br />
<br />
black = white + 1<br />
<br />
We can enter now, finish on a black field and draw another black to black line. Or enter later.<br />
<br />
black = white - 1<br />
<br />
A white to white line is possible in either case.<br />
<br />
black = white - 2<br />
<br />
We cannot enter now, because even if we end on a white field, only one white remains, and that is not the corner. And cannot enter later either.</div><div class="num">79</div></td></tr>
<tr><td><div class="border"></div><div>The same procedure applies at 6 distance.<br />
<br />
<img align="top" src="References/6dist.svg" width="38.095238095238%" /><br />
<br />
<b>black = white + 2</b><br />
<br />
The number of black fields is the same as previously, so entering now is not possible.<br />
<br />
black = white + 3 is impossible.<br />
<br />
black = white + 1 and black = white - 1 is possible.<br />
<br />
<b>black = white - 2</b><br />
<br />
Entering now is possible if we step upwards and exit at the neighbouring white field. Two white fields remains.<br />
<br />
But we cannot enter later and make two white to white lines using three white fields.</div><div class="num">80</div></td></tr>
<tr><td><div class="border"></div><div>From now on, we can distinguish between four cases:<br />
<br />
<b>1) Pair distance, pair black and white</b> (indicated by B and W): 4, 8, 12 etc. distance<br />
<br />
If we enter now and exit on black, B-1 black field remains on the border. B-1 is impair, and the corner alone can make a black to black line. Hence (B-2) / 2 + 1 = B / 2 black to black line would be possible, but...<br />
- if the first line finishes at the corner black, the opportunity for it to make a single line is lost, and the remaining B-1 black fields cannot make B / 2 black lines.<br />
- if it finishes on any other black field, on one side there will be a section that has white fields on both ends (below the greenish fields were taken by the first line)<br />
<br />
<img align="top" src="References/8dist.svg" width="47.619047619048%" /><br />
<br />
A black to black line cannot have three white fields on the border (unless more black fields were used up).<br />
<br />
So there can be at most B / 2 - 1 black to black lines.<br />
<br />
If we enter now and exit on white, W-1 white fields remain, so 1 + (W-2) / 2 = W / 2 white to white lines is possible.<br />
<br />
If we enter later, the number of possible black to black lines is at most B / 2, and the white ones W / 2.</div><div class="num">81</div></td></tr>
<tr><td><div class="border"></div><div>Our rule will look like this: If the number of black fields in the area is greater or equal than the number of white fields plus B / 2, we cannot enter now.<br />
<br />
<b>2) Pair distance, impair black and white</b>: 6, 10 etc.<br />
<br />
If we enter now and exit at black, (B-1) / 2 black to black lines can be drawn.<br />
<br />
If we exit at white, (W+1) / 2 white to white lines can be drawn. (We have to move to the corner black and exit at the first white during the first line)<br />
<br />
If we enter later, (B+1) / 2 and (W-1) / 2 black and white lines are possible, respectively.<br />
<br />
The rule is double:<br />
- If the number of black fields is greater or equal than the number of whites plus (B+1) / 2, we cannot enter now.<br />
- If the number of white fields is greater or equal than the number of blacks plus (W+1) / 2, we have to enter now.<br />
<br />
<b>3) Impair distance, impair black and pair white</b>: 5, 9 etc.<br />
<br />
If we enter now and exit at black, (B-1) / 2 black lines are possible.<br />
<br />
If we exit at white, W/2 white lines are possible.</div><div class="num">82</div></td></tr>
<tr><td><div class="border"></div><div>If we enter later, the number of black lines can be up to (B+1)/2, the whites W/2<br />
<br />
Single rule: When the difference is at least (B+1)/2, we cannot enter now.<br />
<br />
<b>4) Impair distance, pair black and impair white</b>: 3, 7 etc.<br />
<br />
If we enter now and exit at black, B / 2 black lines are possible.<br />
<br />
If we exit at white: Similarly to the first of the four cases, a black to black edge will remain on one side. Drawing (W-1) / 2 more white lines is either not possible, or if we do so, the corner black may make up a black to black line, decreasing the difference.<br />
<br />
<img align="top" src="References/7dist.svg" width="42.857142857143%" /><br />
<br />
When entering later, B / 2 and (W-1) / 2 are the numbers. Since they match the above, no rule is applied.<br />
<br />
Check the original 21 x 21 example. Two steps back, there will be 9 distance with the wall to the left. The number of black fields on the edge is 5, therefore there cannot be 3 more black fields in the area than white, but counting them, they are 51 and 48.</div><div class="num">83</div></td></tr>
<tr><td><div class="border"></div><div>Does this procedure apply to any of the size-specific rules? Not exactly, but let's look them through. Here are all of them that deal with black and white field imbalance:<br />
<br />
<img align="top" src="References/rules/9_old/Mid Across 3 Impair Determined.svg" width="19.047619047619%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/rules/9_old/Mid Mid Across 3 Determined.svg" width="23.809523809524%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/rules/13_old/Across 3 Impair Determined.svg" width="28.571428571429%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/rules/9_old/Mid Across 3 Impair Determined 2.svg" width="14.285714285714%" /><br />
<img src="References/spacer.svg" height="19.047619047619px" /><br />
<img align="top" src="References/rules/9_old/Double C-Shape Determined.svg" width="14.285714285714%" /><br />
<br />
As a reminder, they indicate impair areas, and in the first two case if the count area start field (black) type is not 1 field more in the area, we cannot enter later.<br />
In the fourth, the field marked with + (white) is the type that needs to be 1 more than black, otherwise stepping forward is forbidden.</div><div class="num">84</div></td></tr>
<tr><td><div class="border"></div><div>I will take the second rule under examination as it contains both a horizontal and vertical offset.<br />
<br />
<img align="top" src="References/2x3dist.svg" width="19.047619047619%" /><br />
<br />
If we enter now:<br />
- We can exit at the end white, so 1 white line is possible.<br />
- We can exit at the black farthest away and then make a line using the black field closest. 1 black line is pssible.<br />
I will mark it like this: 1W -> 1B<br />
<br />
If we enter later:<br />
- Having two black fields, 1 black line is possible.<br />
- There is only one white field. It sits in a corner, but the two black fields will give 1 black line. 0 white line is possible.<br />
0W -> 1B<br />
<br />
So if there are 1 more white fields in the area than black (1W), we cannot enter later.</div><div class="num">85</div></td></tr>
<tr><td><div class="border"></div><div>Now let's increase the vertical distance.<br />
<br />
<img align="top" src="References/2x4dist.svg" width="19.047619047619%" /><br />
<br />
If we enter now, 1 white line to 2 black lines are possible. There are 2 black fields on a corner.<br />
1W -> 2B<br />
Later, 0 white line and 2 black lines can be drawn.<br />
0W -> 2B<br />
<br />
Conclusion: in case of 1W, we cannot enter later.<br />
<br />
5 distance:<br />
<br />
<img align="top" src="References/2x5dist.svg" width="19.047619047619%" /><br />
<br />
Now: 2W -> 1B<br />
Later: 1W -> 2B<br />
2W: cannot enter later<br />
2B: cannot enter now</div><div class="num">86</div></td></tr>
<tr><td><div class="border"></div><div>6 distance:<br />
<br />
<img align="top" src="References/2x6dist.svg" width="19.047619047619%" /><br />
<br />
Now: 1W -> 2B<br />
Later: 1W -> 3B<br />
3B: cannot enter now<br />
<br />
7 distance:<br />
<br />
<img align="top" src="References/2x7dist.svg" width="19.047619047619%" /><br />
<br />
Now: 2W -> 2B<br />
Later: 2W -> 2B<br />
No rule.</div><div class="num">87</div></td></tr>
<tr><td><div class="border"></div><div>In case of 7, there are 4 fields added to the 3-distance example. We would expect that in case of 2W, we cannot enter later, but now, 2W is possible even when entering later, because one line will be the corner white, and the other can go between the other two white fields, taking up all the blacks along the way.<br />
From now on, increasing the numbers by 1 for every 4 distance increase will work.<br />
<br />
The next thing to do is the horizontal increase.<br />
<br />
3 distance:<br />
<br />
<img align="top" src="References/3x3dist.svg" width="23.809523809524%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/3x3dist_1.svg" width="23.809523809524%" /><br />
<br />
The picture on the left is the representation we have used so far. However, we cannot exit at the black in the middle, and when we exit at one of the whites, the other is only accessible for immediate entry. Therefore, I will add the extra field. If there is a taken field anywhere ahead acting as the obstacle, we can get to it by drawing a straight line and a stair.<br />
<br />
Now: 0W -> 2B<br />
Later: 1B -> 2B<br />
If we used all 3 black corners for a separate line, we would not enter the area.</div><div class="num">88</div></td></tr>
<tr><td><div class="border"></div><div>4 distance:<br />
<br />
<img align="top" src="References/4x3dist.svg" width="28.571428571429%" />		<br />
<br />
Now: 2W -> 0B<br />
If we exited at the nearest white after entering, we have either not entered the area or not filled the black field.<br />
Later: 2W -> 0B<br />
<br />
5 distance:<br />
<br />
<img align="top" src="References/5x3dist.svg" width="33.333333333333%" /><br />
<br />
Now: 0W -> 3B<br />
If we reserved the 3 black corners, the only way to end the first line on black is to move downwards after entry.<br />
Later: 0W -> 3B</div><div class="num">89</div></td></tr>
<tr><td><div class="border"></div><div>6 distance:<br />
<br />
<img align="top" src="References/6x3dist.svg" width="38.095238095238%" /><br />
<br />
Now: 3W -> 1B<br />
Similarly, we need to move down after entry in order to finish at the second black field, leaving the first for itself.<br />
Later: 3W -> 1B<br />
<br />
7 distance:<br />
<br />
<img align="top" src="References/7x3dist.svg" width="42.857142857143%" /><br />
<br />
Now: 1W -> 3B<br />
Later: 0W -> 4B<br />
There cannot be one white line, because out of the first three black fields only 2 would be filled.<br />
<br />
Notice that as we added 4 distance to 3, now both the white and the black end of the ranges have increased by one.</div><div class="num">90</div></td></tr>
<tr><td><div class="border"></div><div>But we are not finished, we still need to examine the distance of 8.<br />
<br />
<img align="top" src="References/8x3dist.svg" width="47.619047619048%" /><br />
<br />
Now: 4W -> 1B<br />
After entry, we need to move up to fill the corner black and exit at the first white field.<br />
At 4 distance, only 2W was possible, but now we can exit at the first white and fill the area when entering at the second and exiting at the third.<br />
Later: 3W -> 1B<br />
<br />
After this practice, let's calculate how many white and black lines we can draw when we have an obstacle x and y distance away.<br />
<br />
There are three cases to look at.</div><div class="num">91</div></td></tr>
<tr><td><div class="border"></div><div>1. Equal horizontal and vertical distance<br />
<br />
<img align="top" src="References/xdist.svg" width="28.571428571429%" /><br />
<br />
There are an x number of black fields on the area boundary.<br />
<br />
x = 1:<br />
Now: 0W -> 0B<br />
We cannot enter later.<br />
<br />
x = 2:<br />
Now: 0W -> 1B<br />
Later: 1B<br />
<br />
x = 3:<br />
Now: 0W -> 2B<br />
Later: 1B -> 2B<br />
<br />
x = 4:<br />
Now: 0W -> 3B<br />
Later: 1B -> 3B</div><div class="num">92</div></td></tr>
<tr><td><div class="border"></div><div>x = n:<br />
Now: 0W -> (n-1)B<br />
Later: 1B -> (n-1)B<br />
There is an x amount of corner blacks, but we need to enter the area as well. <br />
<br />
Conclusion: if the white and black fields in the area are equal, we cannot enter later.<br />
<br />
2. Larger horizontal distance<br />
<br />
<img align="top" src="References/x 2n.svg" width="47.619047619048%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/x 2n 1.svg" width="47.619047619048%" /></div><div class="num">93</div></td></tr>
<tr><td><div class="border"></div><div><b>If the added distance is pair:</b><br />
<br />
2n = 2:<br />
<br />
<img align="top" src="References/2n=2.svg" width="38.095238095238%" /><br />
<br />
Now: Can we make 1W? No, because that would require going through the first black field to end at the first white, while filling the other parts of the area too.<br />
What about the black line count? Without the horizontal addition, (x-1)B was possible. Can we now make x amount? Yes, by stepping down and ending the line at the first white field and the second black, having filled everything except the corner blacks.<br />
0W -> xB<br />
<br />
Later: We can use all corner blacks, and the line starting at the first white and ending at the second black will fill the area.<br />
0W -> xB</div><div class="num">94</div></td></tr>
<tr><td><div class="border"></div><div>2n = 4:<br />
<br />
<img align="top" src="References/2n=4.svg" width="47.619047619048%" /><br />
<br />
Now: 1W is now possible by ending at the second white, and everything can be filled on the way, while (x+1)B is not possible. Two inline blacks remain after taking off all the corner blacks, and we have to use one of them to exit the first line.<br />
1W -> xB<br />
<br />
Later: 1W -> (x+1)B<br />
The line connecting the two inline blacks can fill the rest of the area.</div><div class="num">95</div></td></tr>
<tr><td><div class="border"></div><div>2n = 6:<br />
<br />
<img align="top" src="References/2n=6.svg" width="57.142857142857%" /><br />
<br />
Now: If the first line goes through the first black and exits at the first white, the second line can go between the remaining two whites.<br />
As far as the blacks concerned, if we exit at the second black, we can use the third and fourth for a line, plus the x amount of corners.<br />
2W -> (x+1)B<br />
<br />
Later: Because of three inline white fields, one white line is possible. For blacks, we can use all the corners and two out of the three inline blacks.<br />
1W -> (x+1)B</div><div class="num">96</div></td></tr>
<tr><td><div class="border"></div><div>We don't need more examples.<br />
<br />
For 2n added fields, there will be n amount of inline white fields.<br />
<br />
If we enter now, (n+1 - (n+1) % 2 ) / 2 white lines can be drawn if n > 1.<br />
The black line count is all the corners minus one for finishing the first line, plus one for each remaining pair.<br />
x + (n-1 - (n-1) % 2 ) / 2<br />
<br />
For entering later, the white line count is (n - n % 2 ) / 2, and the black line count is x + (n - n % 2 ) / 2.</div><div class="num">97</div></td></tr>
<tr><td><div class="border"></div><div><b>If the added distance is impair:</b><br />
<br />
2n + 1 = 1, n = 0:<br />
<br />
<img align="top" src="References/2n 1=1.svg" width="33.333333333333%" /><br />
<br />
Now: If we end the first line at the first white, we could not have filled the corner black and the area simultaneously. xW is therefore not possible, but (x-1)W is.<br />
And since there is only one black field, the black line count will be 0.<br />
(x-1)W -> 0B<br />
<br />
Later: All the corner whites plus the neutral line makes (x-1)W. The black line count is still 0. The black field is a corner, but it will be counterbalanced by at least one white to white line.<br />
(x-1)W -> 0B</div><div class="num">98</div></td></tr>
<tr><td><div class="border"></div><div>2n + 1 = 3, n = 1:<br />
<br />
<img align="top" src="References/2n 1=3.svg" width="42.857142857143%" /><br />
<br />
Now: Aside the corner whites, 1W is possible by ending at the second white, just like in the 2n = 4 case.<br />
The black line count is now 1, but we need to step downwards and finish at the first white and second black in order to have the corner black available.<br />
xW -> 1B<br />
<br />
Later: xW -> 1B</div><div class="num">99</div></td></tr>
<tr><td><div class="border"></div><div>2n + 1 = 5, n = 2:<br />
<br />
<img align="top" src="References/2n 1=5.svg" width="52.380952380952%" /><br />
<br />
Now: We can step up and finish at the first white, because line connecting the remaining two whites can fill the area.<br />
(x+1)W -> 1B<br />
<br />
Later: xW -> 2B<br />
<br />
From now on, the calculations are the following:<br />
<br />
If we enter now, x + (n - n % 2) / 2 white lines can be drawn if n > 0.<br />
The number of black fields is n+1, and when we use up one to finish the first line, n amount remains, one of which is a corner. Add one to make pairs, and the formula will be (n+1 - (n+1) % 2) / 2.<br />
<br />
When entering later, the white line count is x-1 + (n+1 - (n+1) % 2) / 2, and the black line count is (n+2 - (n+2) % 2) / 2 if n > 0.</div><div class="num">100</div></td></tr>
<tr><td><div class="border"></div><div>3. Larger vertical distance<br />
<br />
<img align="top" src="References/2n x.svg" width="28.571428571429%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/2n 1 x.svg" width="28.571428571429%" /></div><div class="num">101</div></td></tr>
<tr><td><div class="border"></div><div><b>If the added distance is pair:</b><br />
<br />
2n = 2:<br />
<br />
<img align="top" src="References/2n=2v.svg" width="28.571428571429%" /><br />
<br />
Now: It is possible to exit at the white field, having filled everything. The previous step must have been the last black.<br />
When counting the blacks, we exit the first line at the first black field above the stair, and x amount of corner blacks will remain.<br />
1W -> xB<br />
<br />
Later: Same as the 2n = 2 case previously.<br />
0W -> xB</div><div class="num">102</div></td></tr>
<tr><td><div class="border"></div><div>2n = 4:<br />
<br />
<img align="top" src="References/2n=4v.svg" width="28.571428571429%" /><br />
<br />
Now: There cannot be more than 1W. And the black line count is unchanged too. One of the two inline blacks will be used for completing the first line, and one remains plus x amount of corner.<br />
1W -> xB<br />
<br />
Later: 1W -> (x+1)B</div><div class="num">103</div></td></tr>
<tr><td><div class="border"></div><div>2n = 6:<br />
<br />
<img align="top" src="References/2n=6v.svg" width="28.571428571429%" /><br />
<br />
Now: 2W -> (x+1)B<br />
Later: 1W -> (x+1)B<br />
<br />
When entering now, the general formula will be (n+1 - (n+1) % 2) / 2 white and x + (n-1 - (n-1) % 2) / 2 black.<br />
The later case is the same as previously, (n - n % 2 ) / 2 for white and x + (n - n % 2 ) / 2 for black.</div><div class="num">104</div></td></tr>
<tr><td><div class="border"></div><div><b>If the added distance is impair:</b><br />
<br />
2n + 1 = 1, n = 0:<br />
<br />
<img align="top" src="References/2n 1=1v.svg" width="28.571428571429%" /><br />
<br />
Now: 1W -> (x-1)B<br />
Later: (see horizontal case) 0W -> (x-1)B<br />
<br />
2n + 1 = 3, n = 1:<br />
<br />
<img align="top" src="References/2n 1=3v.svg" width="28.571428571429%" /><br />
<br />
Now: 2W -> (x-1)B<br />
Later: 1W -> xB</div><div class="num">105</div></td></tr>
<tr><td><div class="border"></div><div>Now: The corner white always gives 1. Then make pairs with the remaining inline whites plus the white field we are stepping first.<br />
1 + (n+1 - (n+1) % 2) / 2<br />
For the blacks, one of the inline black fields will be taken by the first line. We can then make pairs with the remaining inline blacks and add the corners.<br />
x - 1 + (n - n % 2) / 2.<br />
<br />
Later: The white line count is 1 + (n - n % 2) / 2 if n > 0, and the black line count is x - 1 + (n+1 - (n+1) % 2) / 2.<br />
<br />
Next, we will look at the corner discovery algorithm.<br />
<br />
<img align="top" src="References/cornerDisc.svg" width="28.571428571429%" /><br />
<br />
If the field at 1 horizontal and 1 vertical distance is empty, we check the next field in the row until we find a taken or border field.<br />
Then we walk through the quarter until we get to 0 horizontal distance.<br />
<br />
If, at any point we step right and then up, a corner field is found. If it is going down and left, the area is on the side we want, and we can apply the rule to it.</div><div class="num">106</div></td></tr>
<tr><td><div class="border"></div><div>Compare these two cases:<br />
<br />
<img align="top" src="References/0321.svg" width="80.952380952381%" /><br />
<br />
<img align="top" src="References/0321_1.svg" width="80.952380952381%" /><br />
<br />
The only difference is the added 2x2 area. To the first, we apply the straight-to-side algorithm, while at the second, we have a corner that defines the area, but essentially, the procedure is the same.</div><div class="num">107</div></td></tr>
<tr><td><div class="border"></div><div>Having the universal algorithm, these two size-specific rules can be deleted:<br />
<br />
<img align="top" src="References/rules/9_old/Mid Mid Across 3 Determined.svg" width="23.809523809524%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/rules/13_old/Across 3 Impair Determined.svg" width="28.571428571429%" /><br />
<br />
As we continue the case above, soon we will discover a deficiency which actually has been visible all along.<br />
<br />
<img align="top" src="References/0321_2.svg" width="80.952380952381%" /><br />
<br />
With the border on top, now we have no option to move.</div><div class="num">108</div></td></tr>
<tr><td><div class="border"></div><div>The following rules are active, in addition to the universal one that disables the left field:<br />
<br />
<img align="top" src="References/rules/9_old/Mid Across 3 Impair Determined.svg" width="19.047619047619%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/rules/9_old/Mid Across 3 Impair Determined 2.svg" width="14.285714285714%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/rules/9_old/Double C-Shape.svg" width="14.285714285714%" /><br />
<br />
There are three more black fields in the area than white, so there is not enough vertical distance for entering and exiting that many times.<br />
The straight-to-side algorithm has to be rotated upwards and mirrored, so we get this:<br />
<br />
<img align="top" src="References/4pair up.svg" width="9.5238095238095%" /><br />
<br />
Let's look at the distances from 3 to 6 to have an example of each case of modulo 4.</div><div class="num">109</div></td></tr>
<tr><td><div class="border"></div><div><img align="top" src="References/3dist up.svg" width="9.5238095238095%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/4dist up.svg" width="9.5238095238095%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/5dist up.svg" width="9.5238095238095%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/6dist up.svg" width="9.5238095238095%" /><br />
<br />
D (distance) % 4 = 3:<br />
<br />
Now: 1W -> 0B, 2W -> 1B etc. = (D+1)/4 W -> (D-3)/4 B<br />
Later: 0W -> 1B, 1W -> 2B etc. = (D-3)/4 W -> (D+1)/4 B<br />
(double rule)<br />
<br />
D % 4 = 0:<br />
<br />
Now: 1W -> 0B, 2W -> 1B etc. = D/4 W -> D/4 - 1 B<br />
Later: 1W -> 1B, 2W -> 2B etc. = D/4 W -> D/4 B<br />
(single rule)<br />
<br />
D % 4 = 1:<br />
<br />
Now: 1W -> 1B, 2W -> 2B etc. = (D-1)/4 W -> (D-1)/4 B<br />
Later: 1W -> 1B, 2W -> 2B etc. = (D-1)/4 W -> (D-1)/4 B<br />
(no rule)</div><div class="num">110</div></td></tr>
<tr><td><div class="border"></div><div>D % 4 = 2:<br />
<br />
Now: 2W -> 1B, 3W -> 2B etc. = (D+2)/4 W -> (D-2)/4 B<br />
Later: 1W -> 1B, 2W -> 2B etc. = (D-2)/4 W -> (D-2)/4 B<br />
(single rule)<br />
<br />
And as we step back, we find the point where the line should move in another direction.<br />
<br />
<img align="top" src="References/0326.svg" width="80.952380952381%" /></div><div class="num">111</div></td></tr>
<tr><td><div class="border"></div><div>If we continue the line from here, keeping left, we will run into this situation:<br />
<br />
<img align="top" src="References/0326_1.svg" /></div><div class="num">112</div></td></tr>
<tr><td><div class="border"></div><div>Double C-Shape Determined:<br />
<br />
<img align="top" src="References/rules/9_old/Double C-Shape Determined.svg" width="14.285714285714%" /><br />
<br />
The number of black fields is one more than the whites. Without the size-specific rule, we could step straight. Let me remind you that this rule is based upon the Double C-Shape. If we stepped straight and then into the area, we would come out in the middle, creating two C-shapes.<br />
What this actually means is that there would be two fields of the same color that cannot be filled simultaneously.<br />
If we now extended the area to include the 4 fields straight ahead, there would be still one more black than white, and by stepping straight to a white field, it is clear that a black to black line cannot be drawn.<br />
An extension of the universal rule is necessary to include cases of a "big" area where the obstacle is on the other side of the live end.<br />
<br />
<img align="top" src="References/4pair up big.svg" width="14.285714285714%" /></div><div class="num">113</div></td></tr>
<tr><td><div class="border"></div><div><img align="top" src="References/3dist up big.svg" width="9.5238095238095%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/4dist up big.svg" width="9.5238095238095%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/5dist up big.svg" width="9.5238095238095%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/6dist up big.svg" width="9.5238095238095%" /><br />
<br />
D % 4 = 3:<br />
<br />
Now: 1W -> 0B = (D+1)/4 W -> (D-3)/4 B<br />
Later: 1W -> 0B = (D+1)/4 W -> (D-3)/4 B<br />
(no rule)<br />
<br />
D % 4 = 0:<br />
<br />
Now: 1W -> 0B = D/4 W -> D/4 - 1 B<br />
Later: 1W -> 1B = D/4 W -> D/4 B<br />
(single rule)<br />
<br />
D % 4 = 1:<br />
<br />
Now: 2W -> 0B = (D+3)/4 W -> (D-5)/4 B<br />
Later: 1W -> 1B = (D-1)/4 W -> (D-1)/4 B<br />
(double rule)</div><div class="num">114</div></td></tr>
<tr><td><div class="border"></div><div>D % 4 = 2:<br />
<br />
Now: 2W -> 1B = (D+2)/4 W -> (D-2)/4 B<br />
If the distance is 2, the area has to be W = B if we enter now by stepping straight.<br />
Later: 1W -> 1B = (D-2)/4 W -> (D-2)/4 B<br />
(single rule)<br />
<br />
While this will not solve the case above (we are not able to step left), we can construct one where it is of use when the Double C-Shape Determined rule is turned off.<br />
<br />
<img align="top" src="References/2024_0328_2.svg" width="38.095238095238%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/2024_0328_3.svg" width="38.095238095238%" /></div><div class="num">115</div></td></tr>
<tr><td><div class="border"></div><div>We can now continue working out all scenarios.<br />
<br />
<img align="top" src="References/allcases.svg" width="52.380952380952%" /><br />
<br />
So far we have solved all cases indicated by green:<br />
- 0 vertical distance small area<br />
- x horizontal and y vertical distance small area<br />
- 0 horizontal distance small area<br />
- 0 horizontal distance big area<br />
<br />
I will now take the case of x horizontal and y vertical distance big area.<br />
All representations are the same as in the small area case, only the area is on the other side.<br />
So I will just summarize the black and white limits here.</div><div class="num">116</div></td></tr>
<tr><td><div class="border"></div><div>1. Equal horizontal and vertical distance<br />
<br />
x = 2:<br />
Now: 0W -> 1B<br />
Later: 1B<br />
<br />
x = 3:<br />
Now: 0W -> 2B<br />
Later: 1B -> 2B<br />
<br />
x = n:<br />
Now: 0W -> (n-1)B<br />
Later: 1B -> (n-1)B<br />
<br />
Exactly the same as with the small area.</div><div class="num">117</div></td></tr>
<tr><td><div class="border"></div><div>2. Larger horizontal distance<br />
<br />
<b>If the added distance is pair:</b><br />
<br />
2n = 2:<br />
<br />
Now: 1W is possible. The entry field and the first white is at least 2 distance from each other, the whole area can be filled between them.<br />
1W -> xB<br />
<br />
Later: All corner blacks can be used. The line between the first black and first white will fill the area.<br />
0W -> xB<br />
<br />
General:<br />
<br />
The only difference is the n = 1 case. Otherwise, the number of inline and corner fields are the same.<br />
Now: (n+1 - (n+1) % 2 ) / 2 W -> x + (n-1 - (n-1) % 2 ) / 2 B<br />
Later: (n - n % 2 ) / 2 W -> x + (n - n % 2 ) / 2 B</div><div class="num">118</div></td></tr>
<tr><td><div class="border"></div><div><b>If the added distance is impair:</b><br />
<br />
2n + 1 = 1, n = 0:<br />
<br />
Now: xW is possible.<br />
xW -> 0B<br />
<br />
Later: Same values as previously.<br />
(x-1)W -> 0B<br />
<br />
2n + 1 = 3, n = 1:<br />
<br />
Note that in the small area case, there were x-1 corner whites and 1 corner black. Now there are x amount of corner whites and 2 inline blacks insted of 1.<br />
<br />
Now: xW -> 0B<br />
Later: xW -> 1B<br />
<br />
2n + 1 = 5, n = 2:<br />
<br />
Now: (x+1)W -> 1B<br />
Later: (x+1)W -> 1B<br />
<br />
General:<br />
<br />
Now: x + (n+1 - (n+1) % 2) / 2 W -> (n - n % 2) / 2 B<br />
Later: x + (n - n % 2) / 2 W if n > 0 -> (n+1 - (n+1) % 2) / 2 B</div><div class="num">119</div></td></tr>
<tr><td><div class="border"></div><div>3. Larger vertical distance<br />
<br />
<b>If the added distance is pair:</b><br />
<br />
We will find it is the same as the small area.<br />
<br />
2n = 2:<br />
<br />
Now: 1W -> xB<br />
Later: 0W -> xB<br />
<br />
2n = 4:<br />
<br />
Now: 1W -> xB<br />
Later: 1W -> (x+1)B<br />
<br />
General:<br />
<br />
Now: (n+1 - (n+1) % 2) / 2 W -> x + (n-1 - (n-1) % 2) / 2 B<br />
Later: (n - n % 2) / 2 W -> x + (n - n % 2) / 2 B</div><div class="num">120</div></td></tr>
<tr><td><div class="border"></div><div><b>If the added distance is impair:</b><br />
<br />
2n + 1 = 1, n = 0:<br />
<br />
Now: 1W -> (x-1)B<br />
Later: 0W -> (x-1)B<br />
<br />
2n + 1 = 3, n = 1:<br />
<br />
Here comes the change again, due to having one more corner black field and one less corner white field than in the small area case.<br />
<br />
Now: 1W -> xB<br />
Later: 1W -> xB<br />
<br />
General:<br />
<br />
Now: If n > 0, we can use all corner blacks after exiting the first line.<br />
(n+2 - (n+2) % 2) / 2 W -> x + (n-1 - (n-1) % 2) / 2 B if n > 0.<br />
Later: (n+1 - (n+1) % 2) / 2 W -> x + (n - n % 2) / 2 B if n > 0.</div><div class="num">121</div></td></tr>
<tr><td><div class="border"></div><div>While creating a case to verify the newly created rule set, I have encountered this:<br />
<br />
<img align="top" src="References/2024_0330.svg" width="47.619047619048%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/2024_0330_1.svg" width="47.619047619048%" /><br />
<br />
It is not possible to continue after stepping upwards.<br />
But where is the missing part?</div><div class="num">122</div></td></tr>
<tr><td><div class="border"></div><div>On the left, the largest area contains 1 more white field than black, and on the right it is 2 more black. It would be possible if the upper left corner was filled, like ths:<br />
<br />
<img align="top" src="References/2024_0330_2.svg" width="47.619047619048%" /><br />
<br />
So it is not any of the small area rules and neither the 0 horizontal distance big area rule that has something to do with it.<br />
<br />
One thing is sure, we have been using the small area representations when defining the rule set, which does not give us the minimal area in this case.</div><div class="num">123</div></td></tr>
<tr><td><div class="border"></div><div>See the difference:<br />
<br />
<img align="top" src="References/corner big 4 x 5 big.svg" width="19.047619047619%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/corner big 4 x 5 small.svg" width="19.047619047619%" /><br />
<br />
Can it be a problem?<br />
We will see, but let's look at one detail: If we step upwards, we have to step left to fill the corner white, otherwise it is only good for an exit, which we do not want if the area contains 1 more white fields than black (for the left representation).<br />
After this, we step upwards and then left again. We did not enter the area.<br />
<br />
The 1 added distance case is therefore 0W -> (x-1)B when entering now by stepping upwards and 1W -> (x-1)B when stepping right.<br />
<br />
To simplify things, I will specify the cases again using the minimal area representation.<br />
<br />
Notice that these are the same as the small area patterns, things are just mirrored, so that the previous horizontal expansion is now vertical.</div><div class="num">124</div></td></tr>
<tr><td><div class="border"></div><div>n = 1<br />
<br />
<img align="top" src="References/2n=2 big.svg" width="38.095238095238%" /><br />
<br />
Now: (n+1 - (n+1) % 2) / 2 W -> x + (n-1 - (n-1) % 2) / 2 B<br />
Later: (n - n % 2) / 2 W -> x + (n - n % 2) / 2 B<br />
<br />
n = 0<br />
<br />
<img align="top" src="References/2n 1=1 big.svg" width="33.333333333333%" /><br />
<br />
Now: 1 + (n+1 - (n+1) % 2) / 2 W -> x - 1 + (n - n % 2) / 2 B<br />
Later: 1 + (n - n % 2) / 2 W if n > 0 (0 if n = 0) -> x - 1 + (n+1 - (n+1) % 2) / 2 B</div><div class="num">125</div></td></tr>
<tr><td><div class="border"></div><div>n = 1<br />
<br />
<img align="top" src="References/2n=2v big.svg" width="28.571428571429%" /><br />
<br />
Now: (n+1 - (n+1) % 2) / 2 W if n > 1 (0 if n = 1) -> x + (n-1 - (n-1) % 2) / 2 B<br />
Later: (n - n % 2) / 2 W -> x + (n - n % 2) / 2 B<br />
<br />
n = 0<br />
<br />
<img align="top" src="References/2n 1=1v big.svg" width="28.571428571429%" /><br />
<br />
Now: x - 1 + (n+2 - (n+2) % 2) / 2 W if n > 0 (x - 1 if n = 0) -> (n+1 - (n+1) % 2) / 2 B<br />
Later: x - 1 + (n+1 - (n+1) % 2) / 2 W -> (n+2 - (n+2) % 2) / 2 B if n > 0 (0 if n = 0)</div><div class="num">126</div></td></tr>
<tr><td><div class="border"></div><div>The difference between stepping up and right still remains in these vertical expansion cases. We didn't have to deal with it at the small area, because the line could not step backwards.<br />
It just means we have to remove the Now W conditions for stepping right.<br />
<br />
Now we can continue the case, but we will find that we cannot go past this point:<br />
<br />
<img align="top" src="References/2024_0331_1.svg" width="47.619047619048%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/2024_0331.svg" width="47.619047619048%" /><br />
<br />
The picture on the right is the crossroad. If we step upwards, the area can be completed.<br />
The area between the live end and the corner on the left contains one more black field than white, so the number could be made by stepping left and up, only we cannot step left because of the C-shape.<br />
To make things general, we need to look at, in which cases is the only possibility to step left with the area being on the left side. If the situation both exist on the left and the right side, we cannot step straight.</div><div class="num">127</div></td></tr>
<tr><td><div class="border"></div><div>Remember we have made rules previously that take both sides into account, like this:<br />
<br />
<img align="top" src="References/checknearfield/2 far mid across across.svg" width="28.571428571429%" /><br />
<br />
These cases cannot be solved by a single area pattern.<br />
<br />
C-Shape Next:<br />
<br />
<img align="top" src="References/C-Shape Next.svg" width="14.285714285714%" /><br />
<br />
0 horizontal distance obstacle, area is W = B:<br />
<br />
<img align="top" src="References/AreaUp Next.svg" width="9.5238095238095%" /><br />
<br />
1 horizontal distance, 2 vertical distance obstacle, area is W = B:<br />
<br />
<img align="top" src="References/Corner 2x3 Next.svg" width="14.285714285714%" /></div><div class="num">128</div></td></tr>
<tr><td><div class="border"></div><div>1 horizontal distance, 3 vertical distance obstacle, area is 1B:<br />
<br />
<img align="top" src="References/Corner 2x4 Next.svg" width="14.285714285714%" /><br />
<br />
This can be calculated for any x and y distance obstacle, but we are still missing some single field rules.<br />
<br />
Straight obstacle:<br />
<br />
<img align="top" src="References/straight left.svg" width="14.285714285714%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/straight right.svg" width="14.285714285714%" /><br />
<br />
Besides all the fields straight ahead, the gray field has to be empty in order to apply the rule.</div><div class="num">129</div></td></tr>
<tr><td><div class="border"></div><div><img align="top" src="References/straight 3.svg" width="14.285714285714%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/straight 4.svg" width="14.285714285714%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/straight 5.svg" width="14.285714285714%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/straight 6.svg" width="14.285714285714%" /><br />
<br />
Notice the area is the same as with the case where the obstacle is one field to the right, but there is a difference:<br />
Look at the 3-distance case. Since the obstacle is straight ahead, if we enter now by stepping left, we cannot exit at the black field, because then one of the whites could not have been filled.<br />
The area can only be filled if it is 1W. (This is the case we previously called Double C-Shape.) Adding 4 extra distance does not make the problem disappear: if we exit at the first black and the previous field was the first white, now we get the 5-distance case with 3 white fields and 2 black. A black to black line is therefore not possible.<br />
<br />
These are the new values:<br />
<br />
D % 4 = 3:<br />
<br />
Now: 1W -> -1B = (D+1)/4 W -> (D-7)/4 B<br />
Later: 1W -> 0B = (D+1)/4 W -> (D-3)/4 B<br />
(single rule)</div><div class="num">130</div></td></tr>
<tr><td><div class="border"></div><div>D % 4 = 1:<br />
<br />
Now: 2W -> 0B = (D+3)/4 W -> (D-5)/4 B<br />
Later: 1W -> 0B = (D-1)/4 W -> (D-5)/4 B<br />
(single rule)<br />
<br />
Also, pay attention to the 2-distance case. If we enter now by stepping left, 1W is possible. If we step straight, it is 0W. When the distance is 6, there is no difference, because if the step straight, we can exit the area immediately.<br />
<br />
For straight left and right cases, the rule can be rotated to left or right.<br />
<br />
And here is an example of the x horizontal, 0 vertical distance big area corner. None of the existing cases cover it. The area is impair, so we shouldn't be able to step right.<br />
<br />
<img align="top" src="References/2024_0410.svg" width="33.333333333333%" /><br />
<img src="References/spacer.svg" height="19.047619047619px" /><br />
<img align="top" src="References/area big.svg" width="28.571428571429%" /></div><div class="num">131</div></td></tr>
<tr><td><div class="border"></div><div>When we re-run the program on 9 x 9, it will be obvious that covering all the above 9 cases of area checking still does not solve everything.<br />
<br />
If we don't apply the first size-specific rule, we get stuck here:<br />
<br />
<img align="top" src="References/464.svg" width="42.857142857143%" /><br />
<br />
As a reminder:<br />
<br />
<img align="top" src="References/462.svg" width="42.857142857143%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/rules/9_old/Double Area C-Shape.svg" width="23.809523809524%" /><br />
<br />
Let's put this into the perspective of our current knowledge.</div><div class="num">132</div></td></tr>
<tr><td><div class="border"></div><div>What happens here is that the 3 x 2 area has a certain exit point, the middle, because the area is pair. Then it will create a C-Shape on one side and an area on the other side with a 1-wide gap.<br />
<br />
In general, if we have an area of this shape,<br />
<br />
<img align="top" src="References/464_1.svg" width="23.809523809524%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/464_2.svg" width="28.571428571429%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/464_3.svg" width="33.333333333333%" /><br />
<br />
that consists equal amount of black and white fields, and we enter now, we will exit at the black field, and the preceding field could only have been the farthest corner white, and we can continue backwards through all corner whites like this:<br />
<br />
<img align="top" src="References/Directional Area 0.svg" width="33.333333333333%" /><br />
<br />
If an area is created with either of the directional obstacles, it cannot be filled. I will therefore call the rule Directional Area.</div><div class="num">133</div></td></tr>
<tr><td><div class="border"></div><div>The algorithm first checks if the two fields to the right are empty. Then, starting from the field straight ahead, it takes each field in the row until an obstacle is encountered. If the horizontal distance of the obstacle is vertical distance + 3, the area is of the desired shape and the 3 empty fields on the top are checked.<br />
If the number of black and white fields are equal, the program checks at each corner point on the border if there is a mid across obstacle going to the left, creating a small area on that side.<br />
The whole process is then repeated, increasing the vertical distance, until a non-empty field is found at n horizontal and n&nbsp;+&nbsp;1 vertical distance. <br />
<br />
The fields on the border (blue line) are of course also checked for being empty.<br />
 <br />
You could make the process more bulletproof by including the across obstacles at the corner points or the straight obstacle at the top, but is it necessary? It is not proven until we have a case for them.</div><div class="num">134</div></td></tr>
<tr><td><div class="border"></div><div>But let's continue the program. There are still single area cases we haven't thought about yet. (Previously we had rules for them, but not in the new system.)<br />
<br />
<img align="top" src="References/2024_0419.svg" width="42.857142857143%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/2024_0419_1.svg" width="42.857142857143%" /><br />
<br />
Obviously, at 1 distance we cannot step right, but neither can we at 2 distance if the area is impair. It is because stepping straight allows for 1W, while stepping right only 0W is possible.<br />
<br />
Previously, we represented it like this:<br />
<br />
<img align="top" src="References/checknearfield/far side mid across down.svg" width="19.047619047619%" /><br />
<br />
Reviewing those 2-distance rules, we can see that many of them has a double area (one of which is a C-shape). They cannot be solved with the single area patterns. It is best to re-enable the whole set even if it is a repetition in other cases.</div><div class="num">135</div></td></tr>
<tr><td><div class="border"></div><div>Per our expectation, the program stops at the next double area case.<br />
<br />
<img align="top" src="References/2024_22328.svg" width="42.857142857143%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/2024_22328_1.svg" width="42.857142857143%" /><br />
<br />
What is common in these rules?<br />
<br />
<img align="top" src="References/rules/9_old/Straight Mid Across 3 End Area.svg" width="19.047619047619%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/rules/9_old/Straight Mid Across 3 End C.svg" width="9.5238095238095%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/rules/9_old/Straight Across End Area.svg" width="19.047619047619%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/rules/9_old/Straight Across End C.svg" width="14.285714285714%" /><br />
<img src="References/spacer.svg" height="19.047619047619px" /><br />
<img align="top" src="References/rules/9_old/Straight Across 3 End Area.svg" width="19.047619047619%" /></div><div class="num">136</div></td></tr>
<tr><td><div class="border"></div><div>There is an area with a straight border line of maximum 3 fields, with the obstacle being in the upper left corner. The farthest border field cannot be the exit, the line needs to go downwards from it, but another area is created with one of the obstacles on the up side.<br />
<br />
<img align="top" src="References/Double Area first case.svg" width="19.047619047619%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/Double Area second case.svg" width="19.047619047619%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/Double Area third case.svg" width="19.047619047619%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/Double Area first case rotated.svg" width="28.571428571429%" /><br />
<br />
The live end can be in 3 different positions in relation to the area. All patterns can be rotated clockwise, but the first can also be rotated counter-clockwise, shown in the fourth picture. I call this group of rules Double Area.<br />
<br />
When exiting the first area, we check for mid across and across obstacles on the left side. Why can C-shape checking be omitted? It is already solved by the single area universal rules.<br />
<br />
And the left forbidden field in the first rule is already disabled too.</div><div class="num">137</div></td></tr>
<tr><td><div class="border"></div><div>Take a better look at the third.<br />
The reason the line is not exiting from the corner is that there is one more black field than white:<br />
<br />
<img align="top" src="References/743059_1.svg" width="42.857142857143%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/743059.svg" width="42.857142857143%" /><br />
<br />
So far, we simply assumed that it is the opposite, just because the area is impair, but such a case does not exist. Because of the single area rule with the obstacle, the step to get there is disabled. In the following example the desired area is 1B. So is the area defined by the obstacle on the right.<br />
<br />
<img align="top" src="References/2024_0530_1.svg" width="33.333333333333%" /></div><div class="num">138</div></td></tr>
<tr><td><div class="border"></div><div>When checking the conditions for the first area, these are the fields that need to be empty:<br />
<br />
<img align="top" src="References/double area case 1.svg" width="9.5238095238095%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/double area case 2.svg" width="14.285714285714%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/double area case 3.svg" width="14.285714285714%" /><br />
<br />
Notice that the first two cases can exist simultaneously. Then we examine the smaller area (second case); the obstacle in the first will create a C-shape with the exit of that area and the leftwards step will be disabled by the single area rule:<br />
<br />
<img align="top" src="References/2024_0530_2.svg" width="38.095238095238%" /></div><div class="num">139</div></td></tr>
<tr><td><div class="border"></div><div>Can the border line be longer?<br />
<br />
<img align="top" src="References/double area 4 dist.svg" width="9.5238095238095%" /><br />
<br />
If we look at 4 distance: It is true that if the area is 1W and we step forward, only one white field remains on the border, but we can also exit immediately, leaving a 3-long border line and a 0W area. Then, the area can be entered at the second white and exited at the last black.<br />
<br />
The next stop is similar in concept (Square 4 x 2 C-Shape and Square 4 x 2 Area): When we exit the first area, there are two close obstacles on either side:<br />
<br />
<img align="top" src="References/rules/9_old/Square 4 x 2 C-Shape.svg" width="23.809523809524%" /><img align="top" src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/rules/9_old/Square 4 x 2 Area.svg" width="23.809523809524%" /></div><div class="num">140</div></td></tr>
<tr><td><div class="border"></div><div>The pattern is rotated counter-clockwise.<br />
<br />
<img align="top" src="References/2024_0516.svg" width="42.857142857143%" /><img align="top" src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/2024_0516_1.svg" width="42.857142857143%" /><br />
<br />
We can see that the mechanism is not limited to a few cases, but it can go on indefinitely. If after exiting the area, there are repeated C-shapes on the left side (a stair shape), the right side obstacle may be far away. And the stair can be combined with 2- or maybe 3-long flat walls that make it turn.<br />
<br />
<img align="top" src="References/2024_0531_5.svg" width="38.095238095238%" /><img align="top" src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/2024_0531_3.svg" width="42.857142857143%" /><br />
<br />
A sequence is made from the start area and the close obstacle cases, and this can be programmed.</div><div class="num">141</div></td></tr>
<tr><td><div class="border"></div><div>But let's build the program step by step, based on the discovered 9 x 9 rules. The second case, Triple Area, uses an area where the obstacle is 3 distance away.<br />
<br />
<img align="top" src="References/rules/9_old/Triple Area.svg" width="23.809523809524%" /><br />
<br />
If the area is pair, the exit field will be straight in the middle, and the next step is one to the right. That's where we can check for close obstacles on either side.<br />
Stepping to the left is already disabled in the single area straight obstacle rule. Otherwise, the pattern is rotated, like in the previous case.<br />
<br />
The first obstacle is not necessarily straight ahead. It can be positioned 1 right, and then we get a C-Shape with it when we exit the area. The best representation of the rule I can give is seen on the right.<br />
<br />
<img align="top" src="References/665575.svg" width="42.857142857143%" /><img align="top" src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/Sequence first case.svg" width="23.809523809524%" /></div><div class="num">142</div></td></tr>
<tr><td><div class="border"></div><div>When determining whether is it necessary to consider the followings after exiting the area, there is nothing else to do than looking through existing examples or create new ones.<br />
<br />
- C-shape left<br />
- Mid across left<br />
- Across left<br />
<br />
- Mid across right<br />
- Across right<br />
<br />
In the original Triple Area case, we had a Mid across on both sides.<br />
In the case above, we have the same, plus we have a C-shape on the left side as well. But at the same time, the Directional Area rule is activated too.<br />
So we don't need to include the C-shape into this sequence rule.</div><div class="num">143</div></td></tr>
<tr><td><div class="border"></div><div>But we do need the Across on both sides:<br />
<br />
<img align="top" src="References/2024_0531_1.svg" width="33.333333333333%" /><img align="top" src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/2024_0531_2.svg" width="33.333333333333%" /><br />
<br />
Notice that if the first obstacle placement 4 straight, 1 right, the Directional Area will be activated too at minimal distance.<br />
<br />
<img align="top" src="References/2034760.svg" width="42.857142857143%" /><img align="top" src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/Directional Area.svg" width="33.333333333333%" /><br />
<br />
I have rotated the rule to accomodate both fields that need to be distabled, as well as I added the Across cases for a yellow obstacle. While in theory this is a workable rule, is there a case where the distance to the first obstacle is greater than 3? When I tried to recreate such a scenario, one of the single area rules got in the way.</div><div class="num">144</div></td></tr>
<tr><td><div class="border"></div><div>It is okay to deactivate Directional Area until we get stuck because of the lack of it.<br />
<br />
Double Area Stair will be a 4-step sequence.<br />
<br />
<img align="top" src="References/Double Area Stair numbered.svg" width="33.333333333333%" /><img align="top" src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/Sequence second case.svg" width="23.809523809524%" /><br />
<br />
After exiting the first area, we step to the field 2 straight, 1 right (A). There will be a Mid across obstacle on the left side, so we exit that area at the field marked with B. From the C-shape we exit at C where we encounter a C-shape on the left and an Across obstacle on the right.<br />
We do not code the 4 steps in the program. We are writing a recursive function that calls itself until it runs into the double obstacle case. Notice, the start area is the same as in Square 4 x 2 C-Shape and Square 4 x 2 Area. So these are also solved by this algorithm.</div><div class="num">145</div></td></tr>
<tr><td><div class="border"></div><div>Double Area Stair 2 - although looking similar - will have a somewhat different solution.<br />
<br />
<img align="top" src="References/rules/9_old/Double Area Stair 2.svg" width="23.809523809524%" /><img align="top" src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/Sequence third case.svg" width="19.047619047619%" /><br />
<br />
Because of the start area obstacle, only the forward field will be forbidden. If we step left, the entry point to the area will be of different color, and we do not exit next to the obstacle, but at the field marked forbidden. And if we step right, we have a chance to fill the right-side area first.</div><div class="num">146</div></td></tr>
<tr><td><div class="border"></div><div>Accordingly, there will be 3 ways the rule is rotated.<br />
<br />
<img align="top" src="References/2024_0516_6.svg" width="38.095238095238%" /><br />
<img src="References/spacer.svg" height="19.047619047619px" /><br />
<img align="top" src="References/2024_0516_7.svg" width="38.095238095238%" /><img align="top" src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/2024_0516_8.svg" width="38.095238095238%" /><br />
<br />
We get stuck at 641 027 in a case that was previously solved with Double C-Shape.<br />
<br />
<img align="top" src="References/641027.svg" width="42.857142857143%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/641027_1.svg" width="42.857142857143%" /></div><div class="num">147</div></td></tr>
<tr><td><div class="border"></div><div>If we didn't have the taken field marked with A, the straight obstacle rule would rightfully disable the left field.<br />
<br />
<img align="top" src="References/2024_0517.svg" width="28.571428571429%" /><br />
<br />
We defined the rule to have that field empty, so if the line exits there, it can go somewhere. But this way of thinking is flawed. We don't need to check if that field is empty. If not, some other big area rule will probably prevent getting stuck.<br />
<br />
In the next case, the area is 1W. So if we enter now by stepping straight, we should exit at the last border field. But stepping straight is already disabled.<br />
<br />
<img align="top" src="References/2024_0607_2.svg" width="28.571428571429%" /></div><div class="num">148</div></td></tr>
<tr><td><div class="border"></div><div>Similarly, at 4 distance we cannot even recreate a 1B area if there is an obstacle right to the farthest border field.<br />
<br />
<img align="top" src="References/2024_0607.svg" width="28.571428571429%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/2024_0607_1.svg" width="28.571428571429%" /><br />
<br />
Now, take a look at the following two cases. The first is the well-known Triple Area Exit Down, at over 18 million, while the other comes at around 51 million.<br />
<br />
<img align="top" src="References/18677343 marked.svg" width="42.857142857143%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/51015231 marked.svg" width="42.857142857143%" /><br />
<br />
In the first, we can only step left. In the second, we cannot step left.<br />
It is easy to see that the pattern can be longer. If there is a stair shape downwards with 3 fields at the bottom, there will be a stair backwards, which conflicts with the obstacle on the left (D).</div><div class="num">149</div></td></tr>
<tr><td><div class="border"></div><div>But there are more things that need to be present:<br />
- There should be an obstacle at 2 distance straight ahead to start with.<br />
- If the B and C weren't taken, the area could be filled.<br />
<br />
What is the simplest algorithm to apply?<br />
<br />
In the following, I check these fields as empty, taken or directional taken.<br />
<br />
<img align="top" src="References/Down Stair 0.svg" width="33.333333333333%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/CheckDownStairMidAcross.svg" width="9.5238095238095%" /><br />
<br />
The area enclosed with red line is repeated downwards left, until both of the fields are taken.<br />
For each return step, I check a mid across directional field. Their right and down field need to be empty as well.</div><div class="num">150</div></td></tr>
<tr><td><div class="border"></div><div>Why is C-shape checking to the left unnecessary? It is already taken care of.<br />
<br />
<img align="top" src="References/2024_0528.svg" width="38.095238095238%" /><br />
<br />
To accomodate the Triple Area Exit Down case, let's first check the presence of an obstacle straight ahead at 3 vertical distance. Stepping one forward, we can apply the same procedure.<br />
<br />
The program will soon find a case where there return obstacle is in Across position. So we can add it to the rule.<br />
<br />
<img align="top" src="References/53144883.svg" width="42.857142857143%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/Down Stair.svg" width="38.095238095238%" /></div><div class="num">151</div></td></tr>
<tr><td><div class="border"></div><div>At 59 million, a similar case emerges, but the Stair pattern is not able to solve it. Instead, we can apply the first case of Double Area rotated when stepping one straight.<br />
<br />
<img align="top" src="References/59434452.svg" width="42.857142857143%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/Double Area first case rotated next.svg" width="33.333333333333%" /><br />
<br />
Notice, this could have solved the Triple Area Exit Down as well, but there can be constructed a case where the Next Step Stair pattern will work alone:<br />
<br />
<img align="top" src="References/2024_0604.svg" width="38.095238095238%" /></div><div class="num">152</div></td></tr>
<tr><td><div class="border"></div><div>Soon we encounter a situation that could have been solved by a single area algorithm if we rotated the pattern:<br />
<br />
<img align="top" src="References/59438645.svg" width="42.857142857143%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/2024_0604_1.svg" width="33.333333333333%" /><br />
<br />
And in fact we can take the x and y distance obstacle rule and have it rotated three ways to simplify the program code. And we can group all cases like this. Previously I thought it is only necessary to check the obstacles around the half circle in front of the live end, but an obstacle behind can have an effect too. It is because we do not only have two options to choose from (enter now or later), but there is difference between the "enter now" fields too.</div><div class="num">153</div></td></tr>
<tr><td><div class="border"></div><div><img align="top" src="References/corner 3 rotation.svg" width="42.857142857143%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/straight 3 rotation.svg" width="42.857142857143%" /><br />
<img src="References/spacer.svg" height="19.047619047619px" /><br />
<img align="top" src="References/up 3 rotation.svg" width="42.857142857143%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/up big 3 rotation.svg" width="42.857142857143%" /><br />
<br />
In addition to the gray fields, the area border fields are checked for being empty too.<br />
When disabling a field in a rule, pay attention to its rotation. When the area is large, the direction opposite to the obstacle may be disabled, but doing so is an error in case of a small area.</div><div class="num">154</div></td></tr>
<tr><td><div class="border"></div><div>At 121 million, there is a modification of the original Stair pattern, where two extra fields are added to the bottom. We have to create a more universal rule.<br />
<br />
<img align="top" src="References/121670752.svg" width="42.857142857143%" /><br />
<br />
If we analyze this specific case in terms of a single area, it can be represented like this:<br />
<br />
<img align="top" src="References/areaup corner 4 orig.svg" width="19.047619047619%" /><br />
<br />
The area is 1B, so we can enter now, but the corner black will be filled in itself later, which conflicts with the second obstacle. We have to review the single area rules to add this check to every case where a corner border field is filled separately.</div><div class="num">155</div></td></tr>
<tr><td><div class="border"></div><div>We have seen that the second obstacle can be both mid across and across.<br />
In which area conditions do we run into the issue?<br />
<br />
3 distance:<br />
<br />
<img align="top" src="References/areaup corner 3 2W.svg" width="19.047619047619%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/areaup corner 3 1W.svg" width="19.047619047619%" /><br />
<br />
On the left, we start by stepping left, and the area is 2W.<br />
On the other hand, if we step straight, and the area is 1W, it does not create an issue.<br />
<br />
4 distance:<br />
<br />
<img align="top" src="References/areaup corner 4.svg" width="19.047619047619%" /><br />
<br />
If we step left, it is not possible to exit at the first black (due to the two white fields that cannot be filled simultaneously) and then fill the corner black later.<br />
<br />
If we step straight, 1B is possible.</div><div class="num">156</div></td></tr>
<tr><td><div class="border"></div><div>5 and 6 distance:<br />
<br />
<img align="top" src="References/areaup corner 5 now.svg" width="19.047619047619%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/areaup corner 6.svg" width="19.047619047619%" /><br />
<br />
For entering now 2W and 1B can be completed without relying on the corner field.<br />
However, if we enter later, a 2W area for 5 distance will require a corner fill:<br />
<br />
<img align="top" src="References/areaup corner 5 later.svg" width="19.047619047619%" /><br />
<br />
Where the issue is present, the numbers of possible white or black lines will increase by one for every 4 distance added.</div><div class="num">157</div></td></tr>
<tr><td><div class="border"></div><div>The area to be checked is not exactly the same as in the single area rule with the same obstacle placement. Compare:<br />
<br />
<img align="top" src="References/up 3 rotation.svg" width="42.857142857143%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/up 3 rotation double.svg" width="42.857142857143%" /><br />
<br />
That means, we have to check the new border fields for being empty, and the number for the original area will be:<br />
<br />
For 3 distance: 1W<br />
For 4 distance: 1B<br />
For 5 distance: 1W</div><div class="num">158</div></td></tr>
<tr><td><div class="border"></div><div>A similar approach can be used to incorporate the Double Area cases. Here the difference is that at the corner border field, the line is going from the inside of the area to the next last border field. The second obstacles have to be moved one field upwards.<br />
<br />
<img align="top" src="References/double area case 1 line 3.svg" width="19.047619047619%" /><br />
<br />
We can see that if W = B, then we will step downwards from the corner to exit the area. And that it is only possible to enter by stepping straight.<br />
<br />
But if we add 4 extra distance, should we increase the allowed number of black to black lines, the whites, or should they remain equal?</div><div class="num">159</div></td></tr>
<tr><td><div class="border"></div><div><img align="top" src="References/double area case 1 line 7 w=b.svg" width="19.047619047619%" /><br />
<br />
If W = B, and we step straight, the area can be filled with two lines without a problem. The same can be done if we step left.<br />
If the area is 1W, we can fill the area with one line either way.<br />
<br />
<img align="top" src="References/double area case 1 line 7 1b.svg" width="19.047619047619%" /><br />
<br />
If the area is 1B, we cannot step left to start with. If we step straight, then the situation will be reproduced.<br />
<br />
For the original area, the numbers will be:<br />
For 3 distance: 1B<br />
For 7 distance: 2B etc.</div><div class="num">160</div></td></tr>
<tr><td><div class="border"></div><div>If we look at the 4-distance case, it is evident that even with an 1W area, there is no issue with the second obstacle.<br />
<br />
<img align="top" src="References/areaup corner 4 closed.svg" width="19.047619047619%" /><br />
<br />
At 5 distance, W = B can be filled without issue.<br />
<br />
<img align="top" src="References/areaup corner 5 w=b.svg" width="19.047619047619%" /></div><div class="num">161</div></td></tr>
<tr><td><div class="border"></div><div>At 6 distance, 2W for left movement will result in the problem.<br />
<br />
<img align="top" src="References/areaup corner 6 2w left.svg" width="19.047619047619%" /><br />
<br />
But this case should not occur, because at 7 distance, we are prevented to step straight. In case we were to come from the right side, the x horizontal and y vertical distance rule group has to be updated. More on that later.<br />
<br />
Let's finish this set and look at an 1W area for straight movement. It can go through.<br />
<br />
<img align="top" src="References/areaup corner 6 1w straight.svg" width="19.047619047619%" /></div><div class="num">162</div></td></tr>
<tr><td><div class="border"></div><div>Now we take the second case of Double Area:<br />
<br />
<img align="top" src="References/double area case 2 line 2.svg" width="19.047619047619%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/double area case 2 line 6.svg" width="19.047619047619%" /><br />
<br />
On the left, we step left, and the area is W = B. If we extend the distance, the rule will be valid at 1B as we would expect.<br />
<br />
The third case is:<br />
<br />
<img align="top" src="References/double area case 3 line 3.svg" width="19.047619047619%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/double area case 3 line 7.svg" width="19.047619047619%" /><br />
<br />
At 3 distance, we step left, and the area is 1B.<br />
At 7 distance, it is 2B.</div><div class="num">163</div></td></tr>
<tr><td><div class="border"></div><div>When integrating the rule, pay attention to its rotation. If the obstacles are on the right side, the left field has to be disabled too.<br />
<br />
<img align="top" src="References/2024_0610.svg" width="23.809523809524%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/2024_0610_1.svg" width="23.809523809524%" /><br />
<br />
In the third rotation position, where the first obstacle is behind on the right side, all 3 directions would have to be disabled. Therefore, it is safe to say, such a situation does not exist.<br />
<br />
It has to be said that at this point, the 9 x 9 grid is complete with this set of rules.<br />
My program ran through the left side in 45 hours, producing the expected number of walkthroughs of 1 344 153 757.<br />
<br />
The are a few examples on bigger boards that get stuck, but I don't think they are unsolvable. Let's see if we can fit them into the system we have built up so far. We run the program on 11 x 11, at random.</div><div class="num">164</div></td></tr>
<tr><td><div class="border"></div><div><img align="top" src="References/2024_0618.svg" width="52.380952380952%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/5 dist up lines.svg" width="23.809523809524%" /><br />
<br />
It is again about the movement rules on the area border, but it is a new case. If the area at 5 distance is 1W, we can enter later, but we have to step up from there in order to be able to exit at the farthest white field. The first black field will be filled from left to down.<br />
The field at 2 distance to the left must therefore not be taken.</div><div class="num">165</div></td></tr>
<tr><td><div class="border"></div><div><img align="top" src="References/2024_0618_2.svg" width="52.380952380952%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/areaup corner 4 closed later.svg" width="19.047619047619%" /><br />
<br />
It is a closed corner case where the distance to the obstacle is 4, the area is 1W, and we enter later.<br />
Because the field 1 right and 1 up is taken, the area needs to be defined as:<br />
<br />
<img align="top" src="References/4pair up extended.svg" width="14.285714285714%" /><br />
<br />
The previous rules can be transferred into this new group.</div><div class="num">166</div></td></tr>
<tr><td><div class="border"></div><div><img align="top" src="References/2024_0619.svg" width="52.380952380952%" /><br />
<br />
At the previous step, the big area is 1W. Because of that, in the next step we cannot go straight or right, but there is a mid across obstacle on the other side. We can also say that the movement on the area borderline conflicts the mid across obstacle. Compare the first case with this:<br />
<br />
<img align="top" src="References/5 dist up lines.svg" width="23.809523809524%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/5 dist up lines v2.svg" width="19.047619047619%" /></div><div class="num">167</div></td></tr>
<tr><td><div class="border"></div><div>To group these situations, first we check the area like this:<br />
<br />
<img align="top" src="References/up next.svg" width="9.5238095238095%" /><br />
<br />
Then, depending on the distance, we will know that we need to step up after entering the area in the following cases:<br />
3 distance: 1W<br />
4 distance: 1B, but this situation cannot arise, because then we wouldn't be able to enter the area now.<br />
5 distance: 1W<br />
6 distance: If the area is 1B, it can be filled without having to enter at the first black field or having to step up if we do so.<br />
<br />
The rule has three rotations. The obstacle defining the area can be:<br />
- Up left side<br />
- Right up side<br />
- Bottom right side<br />
<br />
The second obstacle can be either in mid across or across position relative to the entry point as we have seen in the examples.</div><div class="num">168</div></td></tr>
<tr><td><div class="border"></div><div>If we run statistics now, it turns out that without these area border movement rules, the average number of walkthroughs before getting an error is 293, based on 100 attempts. By adding them, the number increases to 695. It tells us that in over half of the failures, this is the solution.<br />
This is a useful tool for debugging too. If, by introducing a new rule set, the errors become more frequent, there is a mistake in the algorithm.<br />
When we finished the 7 x 7 grid, the statistics gave us 5.7 walkthroughs on 11 x 11 using those rules.<br />
By developing the algorithm further, we have solved 99 % of the cases we could not at that time. We get a little less ratio on a 21 x 21 grid, but of a similar order of magniture: 9 vs. 0.2.<br />
<br />
We continue with random examples.<br />
<br />
<img align="top" src="References/2024_0619_1.svg" width="52.380952380952%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/straight small area movement 0.svg" width="19.047619047619%" /><br />
<br />
If we fill all three areas, a field in the middle will be missed.</div><div class="num">169</div></td></tr>
<tr><td><div class="border"></div><div>Let's examine this area:<br />
<br />
<img align="top" src="References/straight small area movement.svg" width="19.047619047619%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/straight small area movement 1.svg" width="19.047619047619%" /><br />
<br />
The area is 1W. We have to enter at the first white field and exit at the second. The second black field needs to be filled, so it gives us two possible enter / exit movements. In either scenario, a mid across obstacle is encountered inside the area.</div><div class="num">170</div></td></tr>
<tr><td><div class="border"></div><div><img align="top" src="References/2024_0624.svg" width="52.380952380952%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/up big extended.svg" width="19.047619047619%" /><br />
<br />
The area is the extended version of the y vertical distance, 0 horizontal distance rule. (The first area we examined in this book.) It is not necessary to decide whether we can enter now or later, it is already taken care of by the other single area groups. But there is a close obstacle at the entry point outside the area. If, at 4 distance, the area is 1W, we enter at the first white field, from which we step down and left.<br />
Therefore, we cannot enter later.</div><div class="num">171</div></td></tr>
<tr><td><div class="border"></div><div><img align="top" src="References/2024_0625.svg" width="52.380952380952%"/><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/corner 2 4 double area.svg" width="23.809523809524%" /><br />
<br />
The first area is 1B, so if we enter now, we will exit at the first black field, coming from above. This creates a second area, which is 1W, so we cannot enter it later.<br />
<br />
The next case is similar, only the first obstacle is closer vertically. The first area is W = B.<br />
<br />
<img align="top" src="References/2024_0625_1.svg" width="52.380952380952%"/><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/corner 2 3 double area.svg" width="23.809523809524%" /></div><div class="num">172</div></td></tr>
<tr><td><div class="border"></div><div><img align="top" src="References/2024_0626_1.svg" width="52.380952380952%" /><br />
<br />
It is a straight obstacle case with extended area where two close obstacles are present outside. The area is 1W according to following illustrations:<br />
<br />
<img align="top" src="References/straight 4 extended.svg" width="19.047619047619%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/straight 4 extended 2.svg" width="19.047619047619%" /><br />
<br />
If we enter later at the first black field, the corner white will have to be filled.<br />
If we enter at the first white field, we collide with the closest close obstacle.</div><div class="num">173</div></td></tr>
<tr><td><div class="border"></div><div>The same area definition at 3 distance will solve Triple Area Exit Down, making the previous solution obsolete. The area is now W = B.<br />
<br />
<img align="top" src="References/18677343.svg" width="42.857142857143%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/straight 3 extended.svg" width="19.047619047619%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/straight 3 extended 2.svg" width="19.047619047619%" /><br />
<br />
The next is a variation of the double area cases. The first area is 1B.<br />
<br />
<img align="top" src="References/2024_0627.svg" width="52.380952380952%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img src="References/up 4 double area.svg" width="23.809523809524%" /></div><div class="num">174</div></td></tr>
<tr><td><div class="border"></div><div><img align="top" src="References/2024_0630.svg" width="52.380952380952%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img src="References/stair area.svg" width="23.809523809524%" /><br />
<br />
Here, we have a stair shape on the left, and an area is created with one of the steps that should be entered now. We can make an algorithm for a stair of any length.</div><div class="num">175</div></td></tr>
<tr><td><div class="border"></div><div><img align="top" src="References/2024_0704.svg" width="52.380952380952%" /><br />
<br />
The sequence algorithm can be applied here. So far, we only checked for C-shapes and close obstacles on the left side when we exit an area, and now we need to add corner discovery to find an obstacle at any x and y distance that creates an area we have to enter now. <br />
<br />
<img align="top" src="References/2024_0706.svg" width="52.380952380952%" /><br />
<br />
Again, the second case of sequence, and the area is on the right side.</div><div class="num">176</div></td></tr>
<tr><td><div class="border"></div><div><img align="top" src="References/2024_0706_1.svg" width="52.380952380952%" /><br />
<br />
It is the first case of sequence where multiple steps have to be applied, just like we did at the second and third case.<br />
<br />
<img align="top" src="References/2024_0709.svg" width="52.380952380952%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/straight 3 extended C.svg" width="19.047619047619%" /><br />
<br />
We saw a similar case on page 174 where there were 2 close obstacles outside the area. We need to add C-shape checking too for an upper obstacle.</div><div class="num">177</div></td></tr>
<tr><td><div class="border"></div><div><img align="top" src="References/2024_0710.svg" width="52.380952380952%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/up extended 3 dist area.svg" width="23.809523809524%" /><br />
<br />
An extension of the case on page 159 where there is an area instead of a close obstacle.</div><div class="num">178</div></td></tr>
<tr><td><div class="border"></div><div><img align="top" src="References/2024_0711.svg" width="52.380952380952%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/corner 3 1 sequence.svg" width="28.571428571429%" /><br />
<br />
This is a more complex situation where we start with an 5 x 3 area which is 1B. In order to fill it after entering at white, we have to exit at the farthest black and then fill the corner black separately.<br />
But when we exit for the first time, a stair shape will force the line on a course that leads to a C-shape on the left and a close across obstacle on the right. The corner black will therefore not be filled.<br />
In the program, we apply sequence after discovering a start area like this. We may consider extending the rule for a larger horizontal distance, adding +1B value for every 4 extension, but it is not safe to do so, because then the area can be filled even if we do not exit at the fartest black for the first time.<br />
<br />
<!--<br />
Group random 11x11 examples in logical order.<br />
In 0710_1, two corners are found as a second area, but only one will evoke the rule. Both of them are displayed though. Secondary circles should always be green.<br />
0712: Unnecessary second area is displayed<br />
cite page numbers when mentioning a rule<br />
create a downstair case with larger horizontal distance<br />
other cases where entering now / later is not relevant in certain rotations?<br />
next step left/right areas should be shown. Find out how to make it in the simplest way.<br />
change yellow background for second directional obstacles <br />
&nbsp; in math expressions<br />
arrow symbol in text<br />
<br />
merge two cases with one that draws a future line with a blue background. <br />
Add future lines on page 144?<br />
<br />
Review CountArea old and new algorithms<br />
<img align="top" src="References/2024_0611_3.svg" width="42.857142857143%" /><br />
<br />
2 688 307 514<br />
1 344 153 757<br />
<br />
104/2 = 52<br />
111712/104 = 1074.15<br />
2 688 307 514 / 111 712 = 24064.63<br />
<br />
+16 fields<br />
+24 fields<br />
+32 fields<br />
<br />
1.2801<br />
	0.0574<br />
1.3375<br />
	0.0331<br />
1.3706<br />
	0.0191<br />
1.3897<br />
<br />
1400 trillion => 1445 trillion<br />
<br />
2024_0611_6: No need for checking next step. (page 108)<br />
<br />
Check if opposite empty fields should be disabled at certain rotations of the 4 rule groups.<br />
<br />
LeftRightAreaUpBig rule presentation on page 97: there is an empty field to the right of the obstacle, which is inconsistent with the examples given. Either change the rule representation and correct it later or change the example / rule.<br />
<br />
<br />
x and y distance obstacle: we check empty fields from the middle line, but it may not be necessary, sequence might be avoided.<br />
<br />
A similar concept will be used when solving Triple Area Exit Down (at over 18 million): The furthest border field have a taken field next to, which limits the possibilities of entering and exiting an area. <br />
<br />
<img align="top" src="References/18665383.svg" width="42.857142857143%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/rules/9/Triple Area Exit Down.svg" width="28.571428571429%" /><br />
<br />
Previously we used open corners:<br />
<br />
<img align="top" src="References/xdist.svg" width="28.571428571429%" /><br />
<br />
Now we have to make calculations for the close corner cases:<br />
<br />
<img align="top" src="References/xdist_closed.svg" width="28.571428571429%" /><br />
<br />
In this specific case, the distance is 3, and the area is 1 black.--><br />
<br />
<!--Now I give you another case to think about. It was discovered by the program previously as 51 015 231.<br />
The second picture is the probable point of choice.<br />
<br />
<img align="top" src="References/51015231.svg" width="42.857142857143%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/51015231_1.svg" width="42.857142857143%" />--><br />
<br />
<!-- Write about optimizing performance / checking close rules first. Is checking next step posibilities necessary? Add 743 056 case to Check3DoubleArea in documentation; add general case where the farthest corner field has to be stepped on separately. There we should check for close obstacles. <br />
<br />
In Double Area, checking C-Shape is not necessary, side straight will take care of it, because area is 1B.<br />
<br />
Double Area first case rotated is the same as Down Stair when there is a mid across obstacle<br />
0529: Double Area first case rotated does not need left C<br />
0529_1: Double Area second case does not need left C<br />
0529_2: Double Area first case does not need left C<br />
0529_3: Double Area third case becomes first case with the obstacle straight ahead (intending left C)<br />
0529_4: Double Area third case needs across<br />
0529_6: Double Area first case and first case rotated needs mid across + across<br />
0529_7: Double Area second case needs mid across + across<br />
0602: Double Area second case needs to be rotated CCW<br />
<br />
Directional Area rule has to be rotated to start with.<br />
<br />
Disable move while task running<br />
<br />
2034760 Is a Directional Area, where the obstacle is across. Find bigger example where Sequence first case is not activated.<br />
Is Directional Area activated at all if distance is bigger than 4, or CheckStraight will disable the fields?<br />
<br />
Replace two images with one where the path changes color at the decision point.<br />
<br />
Sequence second case:<br />
<br />
227 130, Square 4 x 2 C-Shape: Mid across / C-shape left, across right<br />
231 960, Square 4 x 2 Area: Mid across left, across right<br />
2 022 763, Double Area Stair: C-shape, C-shape left, across right<br />
19 720 122, Triple Area Stair: Mid across, C-shape left, across right<br />
0531: Directional Area is the same as Sequence second case (with C-shape on the left at the area exit, only Mid Across seem to exist on the right)<br />
<br />
Sequence third case:<br />
<br />
2 023 198, Double Area Stair 2 C-shape, C-shape left, across right<br />
19 720 614, Double Area Stair Area C-shape, mid across left, across right<br />
<br />
0531_4: New sequence case<br />
<br />
When stepping back on completion, what if the left and right field is possible? Then we need to turn twice to the right.<br />
<br />
--><br />
<br />
<!--Side straight cases, small area:<br />
<br />
<img align="top" src="References/side straight up.svg" width="28.571428571429%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/side straight down.svg" width="28.571428571429%" /><br />
<br />
<img align="top" src="References/side straight 3.svg" width="23.809523809524%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/side straight 4.svg" width="28.571428571429%" /><br />
<img src="References/spacer.svg" height="19.047619047619px" /><br />
<img align="top" src="References/side straight 5.svg" width="33.333333333333%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/side straight 6.svg" width="38.095238095238%" /><br />
<br />
Big area:<br />
<br />
<img align="top" src="References/side straight big up.svg" width="28.571428571429%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/side straight big down.svg" width="28.571428571429%" /><br />
<img src="References/spacer.svg" height="19.047619047619px" /><br />
<img align="top" src="References/side straight big 3.svg" width="23.809523809524%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/side straight big 4.svg" width="28.571428571429%" /><br />
<img src="References/spacer.svg" height="19.047619047619px" /><br />
<img align="top" src="References/side straight big 5.svg" width="33.333333333333%" /><img src="References/spacer.svg" width="4.7619047619048%" /><img align="top" src="References/side straight big 6.svg" width="38.095238095238%" />--></div><div class="num">179</div></td></tr>
 
</table>
